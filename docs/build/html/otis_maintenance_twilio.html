

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4. Updating Twilio for new legal issue &mdash; ILAO 2.22 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../html/_static/css/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../build/html/_static/css/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Site Search" href="site_search.html" />
    <link rel="prev" title="3. Create a rest export for the case acceptance" href="otis_maintenance_case_acceptance_view.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ILAO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="design_guide.html">Design Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_management.html">Custom blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="people_management.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="legal_content_cms.html">Legal Content CMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_pages_cms.html">Basic pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="testimonials_cms.html">Testimonials Content Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="webforms_cms.html">Webforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation_cms.html">Translation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="calendar_cms.html">Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs_cms.html">Job Listings</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion_groups.html">Discussion groups</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="otis_cms.html">Get Legal Help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="otis_endusers.html">Get Legal Help Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_organization_management.html">Organization management</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_endpoints.html">Triage rule endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_reports.html">Get Legal Help Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_ai_integration.html">OTIS AI Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_third_party_support.html">Supported Integrations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="otis_sms_intake.html">Online Intake Over SMS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="otis_sms_intake_architecture.html">General architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="otis_sms_functions.html">Twilio Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="otis_sms_twilio_studio_workflow.html">Get Legal Help text line workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="sms_eviction.html">Eviction SMS Flow</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="otis_maintenance.html">Maintaining and expanding OTIS SMS</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="otis_maintenance.html#expanding-for-new-legal-issues">Expanding for new legal issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="otis_maintenance.html#demographic-taxonomy-terms">Demographic taxonomy terms</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="site_search.html">Site Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_faqs.html">Site FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_cms_features.html">Other Website Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="taxonomies.html">Taxonomies</a></li>
<li class="toctree-l1"><a class="reference internal" href="rss_feeds.html">RSS Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="ilao_api.html">ILAO’s API</a></li>
</ul>
<p class="caption"><span class="caption-text">Workarounds:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="legal_content_cms.html">Legal Content CMS</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="otis_cms.html">Get Legal Help</a> &raquo;</li>
        
          <li><a href="otis_sms_intake.html">Online Intake Over SMS</a> &raquo;</li>
        
          <li><a href="otis_maintenance.html">Maintaining and expanding OTIS SMS</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Updating Twilio for new legal issue</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/otis_maintenance_twilio.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="updating-twilio-for-new-legal-issue">
<h1><span class="section-number">4. </span>Updating Twilio for new legal issue<a class="headerlink" href="#updating-twilio-for-new-legal-issue" title="Permalink to this headline">¶</a></h1>
<div class="section" id="step-1-update-functions">
<h2><span class="section-number">4.1. </span>Step 1: Update functions<a class="headerlink" href="#step-1-update-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="update-the-get-process-function">
<h3><span class="section-number">4.1.1. </span>Update the “get process” function<a class="headerlink" href="#update-the-get-process-function" title="Permalink to this headline">¶</a></h3>
<p>Open the get-process-list function in the guided-nav function under Functions-&gt;Services in Twilio.  There is a case function that contains each of the legal issues supported by the application.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For best results, copy the code to a text editor first in case you need to undo your changes.</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="s2">&quot;1&quot;</span><span class="o">:</span> <span class="c1">//unemployment</span>
<span class="nx">processid</span> <span class="o">=</span> <span class="s2">&quot;9fa873d0-55b8-11eb-939c-0e8d40a13cd5&quot;</span><span class="p">;</span>
<span class="nx">lsc_code</span> <span class="o">=</span> <span class="s2">&quot;76 Unemployment Compensation&quot;</span><span class="p">;</span>
<span class="nx">search_term</span> <span class="o">=</span> <span class="s2">&quot;afa23f49-7a9d-4caf-b9ac-63da005dc20a&quot;</span><span class="p">;</span>
<span class="nx">content_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.illinoislegalaid.org/legal-information/unemployment-benefits&quot;</span><span class="p">;</span>
<span class="nx">rest_export</span> <span class="o">=</span> <span class="s2">&quot;https://www.illinoislegalaid.org/rest/unemployment-cases&quot;</span><span class="p">;</span>
<span class="k">break</span><span class="p">;</span>
</pre></div>
</div>
<p>For each legal issue there is:</p>
<ul class="simple">
<li><p>A case with a number. This matches the number from the SMS widget that asks user to select their problem. Adding a new one should be added after the last one with the next sequential number.</p></li>
<li><p>processid: this is the unique process id from Legal Server</p></li>
<li><p>lsc_code: this should be the string that matches Legal Server’s problem code list</p></li>
<li><p>content_url: this should be a landing page for sending a user when they exit the system for a legal topic.</p></li>
<li><p>rest_export: this is the url for the rest export of the related case acceptance view for the legal issue.</p></li>
</ul>
<p>To add a new issue:
* Add a new case statement with the new information
* Save and deploy the updated function
* Test that the process id is returned. In a browser, open <a class="reference external" href="https://guided-nav-1608.twil.io/get-process-list?issue=">https://guided-nav-1608.twil.io/get-process-list?issue=</a> and append the new number (1,2,3 etc). It should return json like the following:</p>
<blockquote>
<div><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;processid&quot;</span><span class="p">:</span><span class="s2">&quot;9fa873d0-55b8-11eb-939c-0e8d40a13cd5&quot;</span><span class="p">,</span>
<span class="nt">&quot;lsc_code&quot;</span><span class="p">:</span><span class="s2">&quot;76 Unemployment Compensation&quot;</span><span class="p">,</span>
<span class="nt">&quot;search_term&quot;</span><span class="p">:</span><span class="s2">&quot;afa23f49-7a9d-4caf-b9ac-63da005dc20a&quot;</span><span class="p">,</span>
<span class="nt">&quot;content_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.illinoislegalaid.org/legal-information/unemployment-benefits&quot;</span><span class="p">,</span>
<span class="nt">&quot;rest_export&quot;</span><span class="p">:</span><span class="s2">&quot;https://www.illinoislegalaid.org/rest/unemployment-cases&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you get anything other than JSON, you have an error. If you can not find it quickly, undo your changes and ask Gwen for help.</p>
</div>
</div>
<div class="section" id="update-the-validate-process-function">
<h3><span class="section-number">4.1.2. </span>Update the validate process function<a class="headerlink" href="#update-the-validate-process-function" title="Permalink to this headline">¶</a></h3>
<p>In the validate-legal-issue-gn function, there is an array of numbers that are valid input for the list of legal issues. This needs to be updated to include the newly added number from the case statement.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">valid_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">,</span><span class="s2">&quot;6&quot;</span><span class="p">];</span>
</pre></div>
</div>
<p>There is also a series of if statments that can be used for some natural language processing. You can add new variations by copying and pasting the code below and replacing the ‘tanf’ with whatever string you want to match against and updating the response = to the number that corresponds to the legal issue in the list.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span> <span class="k">if</span> <span class="p">(</span><span class="nx">legal_issue</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;tanf&#39;</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">response</span> <span class="o">=</span> <span class="mf">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>All text to search for in the .includes function should be lower-case.</p>
</div>
</div>
</div>
<div class="section" id="step-2-update-the-studio-flow">
<h2><span class="section-number">4.2. </span>Step 2: Update the Studio Flow<a class="headerlink" href="#step-2-update-the-studio-flow" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>In the OTIS flow:</p>
<blockquote>
<div><ul class="simple">
<li><p>Step 1: Add a number and label for the legal issue. This should match the number added in step 1. Eviction should be moved down a number as needed.</p></li>
</ul>
<img alt="_images/twilio-legal-issue-start.png" src="_images/twilio-legal-issue-start.png" />
<ul class="simple">
<li><p>Step 2: Update the legal-issue-split widget to:</p>
<ul>
<li><p>add the number to the post-triage-start route; this will include it in Guided Navigation</p></li>
<li><p>if you moved eviction from 4 to another number, update the exit-to-eviction message.</p></li>
</ul>
</li>
</ul>
<img alt="_images/twilio-split-legal-issue.png" src="_images/twilio-split-legal-issue.png" />
</div></blockquote>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="site_search.html" class="btn btn-neutral float-right" title="Site Search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="otis_maintenance_case_acceptance_view.html" class="btn btn-neutral float-left" title="3. Create a rest export for the case acceptance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Gwen Daniels.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>