<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Twilio Functions &mdash; ILAO Sprint 124a documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/themeoverrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=d5fad431"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Global SMS functions" href="otis_global_functions.html" />
    <link rel="prev" title="Flows and Subflows" href="otis_sms_flows.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ILAO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="design_guide.html">Design &amp; Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_management.html">Custom blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="people_management.html">User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="legal_information.html">Browsing to legal information</a></li>
<li class="toctree-l1"><a class="reference internal" href="legal_content_cms.html">Legal Content CMS</a></li>
<li class="toctree-l1"><a class="reference internal" href="cms_structured_legal_content.html">Next generation content/COPE</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_pages_cms.html">Basic pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="testimonials_cms.html">Testimonials Content Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="webforms_cms.html">Webforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation_cms.html">Translation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="calendar_cms.html">Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs_cms.html">Job Listings</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion_groups.html">Discussion groups</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="otis_cms.html">Get Legal Help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="otis_endusers.html">Get Legal Help Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_organization_management.html">Organization management</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_endpoints.html">Triage rule endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_reports.html">Get Legal Help Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_ai_integration.html">OTIS AI Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_third_party_support.html">Supported Integrations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="otis_sms_intake.html">Online Intake Over SMS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="otis_sms_as_a_user.html">Getting legal help over SMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="otis_sms_intake_architecture.html">General architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="otis_sms_flows.html">Flows and Subflows</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Twilio Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#function-standards">Function standards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oauth-get-token">OAuth get token</a></li>
<li class="toctree-l4"><a class="reference internal" href="#otis-get-confirmation">OTIS get confirmation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#callbacks">Callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#otis-zipcode-validate">OTIS Zipcode Validate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-housing-counselors-list">Get housing counselors list</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-triage-user-database">Update triage user database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-triage-user">Create triage user</a></li>
<li class="toctree-l4"><a class="reference internal" href="#increase-intake-counter">Increase intake counter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geting-guided-navigation-matches">Geting Guided Navigation Matches</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matches-geography">Matches (geography)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matches-names">Matches (names)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-intake-settings-data">Get intake settings data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validate-date-functions">Validate date functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculate-age">Calculate age</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conflict-check">Conflict check</a></li>
<li class="toctree-l4"><a class="reference internal" href="#send-to-legal-server">Send to Legal Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="otis_maintenance.html">Maintaining and expanding OTIS SMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="otis_sms_translations.html">OTIS SMS Translations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="otis_facebook.html">Facebook Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_features.html">Additional Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="site_search.html">Site Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_faqs.html">Site FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_cms_features.html">Other Website Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="taxonomies.html">Taxonomies</a></li>
<li class="toctree-l1"><a class="reference internal" href="rss_feeds.html">RSS Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="ilao_api.html">ILAO’s API</a></li>
<li class="toctree-l1"><a class="reference internal" href="next_steps.html">Next Steps Flows</a></li>
<li class="toctree-l1"><a class="reference internal" href="sms_overview.html">SMS Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_analytics.html">Data and Analytics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">See also:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="creating_docs_in_github.html">Creating new docs in Github</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="otis_cms.html">Get Legal Help</a></li>
          <li class="breadcrumb-item"><a href="otis_sms_intake.html">Online Intake Over SMS</a></li>
      <li class="breadcrumb-item active">Twilio Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/otis_sms_functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="twilio-functions">
<span id="id1"></span><h1>Twilio Functions<a class="headerlink" href="#twilio-functions" title="Link to this heading"></a></h1>
<p>This documents the functions stored in our Twilio function service “ilao.”</p>
<p>All of our Twilio functions are stored in the ilao service in Twilio’s functions.</p>
<p>Guided navigation functions used in our Twilio SMS are documented in <a class="reference internal" href="otis_guided_nav_functions.html#guided-nav-functions"><span class="std std-ref">Guided Navigation SMS functions</span></a> documentation.</p>
<section id="function-standards">
<h2>Function standards<a class="headerlink" href="#function-standards" title="Link to this heading"></a></h2>
<p>All function names are written in the word-word-word format.</p>
<p>All passed in parameters are contained in the event object.</p>
</section>
<section id="oauth-get-token">
<h2>OAuth get token<a class="headerlink" href="#oauth-get-token" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong>  oauth-get-token</p>
<p><strong>Parameters:</strong>  none</p>
<p><strong>Returns:</strong> an access token</p>
<p><strong>Requires:</strong>  A consumer for our API account and a user account to call.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following functions rely on the OAuth token:</p>
</div>
<ul class="simple">
<li><p>otis-create-triage-user</p></li>
<li><p>otis-triage-user</p></li>
<li><p>eviction-intake-settings</p></li>
<li><p>otis-get-matches</p></li>
<li><p>eviction-matches</p></li>
</ul>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="otis_global_functions.html">Global SMS functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-total-income">OTIS Validate Total Income</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-payments">OTIS Validate Payments</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-benefit-types">OTIS Validate Benefit Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#id1">OTIS Validate Benefit Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-money-input">OTIS Validate Money Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#load-marital-statuses">Load marital statuses</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#load-languages">Load languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#load-genders">Load genders</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#load-ethnicities">Load ethnicities</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#load-races">Load races</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-race">OTIS Validate Race</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-ethnicity">OTIS Validate Ethnicity</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-gender">OTIS Validate Gender</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-marital-status">OTIS Validate Marital Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-preferred-language">OTIS Validate Preferred Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-year">OTIS Validate Year</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-day-of-month">OTIS Validate Day of Month</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-validate-month">OTIS Validate Month</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-calculate-age">OTIS Calculate Age</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#otis-poverty-estimate">OTIS Poverty Estimate</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_global_functions.html#id2">OTIS validate total income</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="otis_eviction_functions.html">Eviction functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="otis_eviction_functions.html#eviction-intake-settings">Eviction intake settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_eviction_functions.html#eviction-legal-issues">Eviction legal issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_eviction_functions.html#eviction-content">Eviction content</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_eviction_functions.html#hud-housing-counselors">HUD housing counselors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="otis_triage_intake_functions.html">OTIS SMS intake/triage functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="otis_guided_nav_functions.html">Guided Navigation SMS functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#validate-keyword">Validate keyword</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#validate-legal-issue">Validate legal issue</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#get-process-list">Get process list</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#start-a-new-session-for-given-process">Start a new session for given process</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#get-the-guided-navigation-form">Get the guided navigation form</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#save-form-data-submitted-for-a-session">Save form data submitted for a session</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#getting-the-current-form">Getting the current form</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#getting-guided-navigation-matches">Getting Guided Navigation matches</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_guided_nav_functions.html#process-qualifiers">Process qualifiers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="otis_website_data_integration_functions.html">OTIS Data Integration Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="otis_website_data_integration_functions.html#create-triage-user">Create Triage User</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_website_data_integration_functions.html#otis-update-triage-user">OTIS Update Triage User</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="otis-get-confirmation">
<h2>OTIS get confirmation<a class="headerlink" href="#otis-get-confirmation" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong>  otis-get-confirmation</p>
<p><strong>Parameters:</strong>  event.intakeSettingsId and event.callbackType</p>
<p><strong>Requires:</strong>  ILAO API call to get the return message based on the intake settings id and callback type.</p>
<p><strong>Status:</strong>  This is a placeholder function right now. It returns either the “we call” or “you call” message” as a JSON object.</p>
</section>
<section id="callbacks">
<h2>Callbacks<a class="headerlink" href="#callbacks" title="Link to this heading"></a></h2>
<section id="otis-get-callback-slots">
<h3>OTIS Get Callback Slots<a class="headerlink" href="#otis-get-callback-slots" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong> pilot-get-callback-slots</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.token</p></li>
<li><p>event.settings_id</p></li>
<li><p>event.language</p></li>
</ul>
<p><strong>Returns:</strong> An object that contains the available callback slots for the matched organization.</p>
<p><strong>Purpose:</strong> Gathers the available callback slots for the organization the applicant applied</p>
<p><strong>Widget:</strong> get-callback-times</p>
<p><strong>Flow:</strong> OTIS appointment scheduler</p>
</section>
<section id="otis-get-callback-slots-by-day">
<h3>OTIS Get Callback Slots by Day<a class="headerlink" href="#otis-get-callback-slots-by-day" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong> pilot-get-next-days-slots</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.values</p></li>
<li><p>event.index</p></li>
</ul>
<p><strong>Returns:</strong> An object that contains the available appointment times for the selected day.</p>
<p><strong>Widget:</strong> get-callback-slots-by-day</p>
<p><strong>Flow:</strong> OTIS appointment scheduler</p>
</section>
<section id="otis-get-callback-days-deprecated">
<h3>OTIS Get Callback Days (Deprecated?)<a class="headerlink" href="#otis-get-callback-days-deprecated" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong>  otis-get-callback-days</p>
<p><strong>Parameters:</strong>  event.intakeSettingsId</p>
<p><strong>Requires:</strong>  ILAO API call to get the next [x] days of available intake appointments.</p>
<p><strong>Status:</strong>  This is a placeholder function right now. It returns a JSON object of days for the user to pick from. Currently, it is using an array of days and a string of days to output. This needs to be revised to return a key value pair that can be rendered while still having useful info for the system.</p>
</section>
<section id="otis-get-first-callback-time-deprecated">
<h3>OTIS Get First Callback Time (Deprecated?)<a class="headerlink" href="#otis-get-first-callback-time-deprecated" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong>  otis-get-first-callback-time</p>
<p><strong>Parameters:</strong>  event.intakeSettingsId</p>
<p><strong>Requires:</strong>  ILAO API call to get the range of available hours and the first available date.</p>
<p><strong>Status:</strong>  This is a placeholder function right now. It returns a JSON object of days for the user to pick from. It currently returns hard-coded text of:</p>
<ul class="simple">
<li><p>intro (‘Callback times are between x and y’);</p></li>
<li><p>first (‘The first available is [x]);</p></li>
<li><p>callback-date: Stores the actual date in mm/dd/yyyy format.</p></li>
</ul>
</section>
<section id="otis-get-callback-times-deprecated">
<h3>OTIS Get Callback Times (Deprecated?)<a class="headerlink" href="#otis-get-callback-times-deprecated" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong>  otis-get-callback-times</p>
<p><strong>Parameters:</strong>  event.intakeSettingsId, event.callbackDate</p>
<p><strong>Requires:</strong>  ILAO API call to get the range of callback slots for a specific date and intake settings pairing.</p>
<p><strong>Status:</strong>  This is a placeholder function right now. It returns a JSON object of times for the user to pick from. It currently returns hard-coded text of:</p>
<ul class="simple">
<li><p>timeArray of available times</p></li>
<li><p>times - string of times to display to user</p></li>
</ul>
</section>
<section id="otis-get-callback-type-deprecated">
<h3>OTIS Get Callback Type (Deprecated)<a class="headerlink" href="#otis-get-callback-type-deprecated" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong>  otis-get-callback-times</p>
<p><strong>Parameters:</strong>  event.intakeSettingsId</p>
<p><strong>Requires:</strong>  ILAO API call to get the callback type for a specific intake settings</p>
<p><strong>Status:</strong>  This is a placeholder function right now. It returns a string of either “clientCalls” or “weCallClient”</p>
</section>
</section>
<section id="otis-zipcode-validate">
<h2>OTIS Zipcode Validate<a class="headerlink" href="#otis-zipcode-validate" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong></p>
<ul class="simple">
<li><p>pilot-validate-zipcode (current)</p></li>
<li><p>otis-zipcode-validate (deprecated)</p></li>
</ul>
<p><strong>Purpose</strong>: Determines whether a provided zip code is in Illinois or not based on the Illinois regions asset, which is a JSON file from ILAO’s region taxonomy and includes the zipcode, city, county, state, fips ID, and county UUID.</p>
<p><strong>Parameters:</strong>  event.zip</p>
<p><strong>Requires:</strong>  API call to get region information based on zip code.</p>
<p><strong>Returns:</strong> An object (location) that contains:</p>
<ul class="simple">
<li><p>zip_code (the zip provided by the user)</p></li>
<li><p>county</p></li>
<li><p>state</p></li>
<li><p>fips id for the county (required by Legal Server)</p></li>
</ul>
<p><strong>Status:</strong> Relies on a JSON object in our static assets (/illinois-regions) that contains the IL regional taxonomy data.</p>
<p><strong>Widget:</strong></p>
<ul class="simple">
<li><p>validate-zipcode</p></li>
<li><p>validate-zipcode-counselor</p></li>
</ul>
<p><strong>Flow:</strong> OTIS get location</p>
</section>
<section id="get-housing-counselors-list">
<h2>Get housing counselors list<a class="headerlink" href="#get-housing-counselors-list" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This only appears when an applicant identifies as having an eviction-related issue. During this special triage section, we first ask if the applicant wants information on housing counselors.</p>
</div>
<p><strong>Function:</strong> hud-housing-counselors</p>
<p><strong>Purpose:</strong> Performs an API call to provide the applicant with a list of local housing counselors.</p>
<p><strong>Parameters:</strong> event.zip</p>
<p><strong>Returns:</strong> An object that contains:</p>
<ul class="simple">
<li><p>counseling_agencies (limited to agencies that service the user’s zip code)</p></li>
<li><p>name (the name of the agency)</p></li>
<li><p>address (the agency’s street address)</p></li>
<li><p>city</p></li>
<li><p>phone</p></li>
<li><p>weburl</p></li>
<li><p>counslg_METHOD (the method the applicant can communicate with the agency – i.e., face-to-face, phone counseling, group counseling, etc.)</p></li>
</ul>
<p><strong>Widget:</strong> get-counseling</p>
<p><strong>Flow:</strong> OTIS get location</p>
</section>
<section id="update-triage-user-database">
<h2>Update triage user database<a class="headerlink" href="#update-triage-user-database" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong> otis-update-triage-user</p>
<p><strong>Purpose:</strong> Update the OTIS triage user database with information from the user’s triage path.</p>
<p><strong>Parameters:</strong> event.token</p>
<p><strong>Returns:</strong> an object that contains a uuid</p>
<p><strong>Widgets:</strong></p>
<ul class="simple">
<li><p>update-counseling (Get location)</p></li>
<li><p>update-gn-triage-user (guided navigation)</p></li>
<li><p>update-triage-user-matches (matches)</p></li>
<li><p>update-triage-user-age (intake)</p></li>
<li><p>update-triage-user-demo (intake)</p></li>
<li><p>update-triage-user-income (intake)</p></li>
<li><p>update-triage-user-contact (contact)</p></li>
<li><p>update-triage-you-call (superbot)</p></li>
<li><p>update-triage-we-call (superbot)</p></li>
<li><p>update-triage-on-etransfer (superbot)</p></li>
</ul>
<p><strong>Flows:</strong></p>
<ul class="simple">
<li><p>OTIS get location</p></li>
<li><p>OTIS Guided Navigation</p></li>
<li><p>OTIS matches</p></li>
<li><p>OTIS Intake</p></li>
<li><p>OTIS contact information</p></li>
<li><p>Superbot flows: SuperbotV2 &amp; SuperbotV3</p></li>
</ul>
</section>
<section id="create-triage-user">
<h2>Create triage user<a class="headerlink" href="#create-triage-user" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong> otis-create-triage-user</p>
<p><strong>Purpose:</strong> Create a new triage user in the database</p>
<p><strong>Parameters:</strong> event.token</p>
<p><strong>Returns:</strong> triage_id</p>
<p><strong>Widget:</strong> create-triage-user</p>
<p><strong>Flows:</strong> Superbot flows: SuperbotV2 &amp; SuperbotV3</p>
</section>
<section id="increase-intake-counter">
<h2>Increase intake counter<a class="headerlink" href="#increase-intake-counter" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong>  otis-increase-intake-counter</p>
<p><strong>Purpose</strong>:  Updates the current count for an intake setings id when a case is successfully transferred to Legal Server.</p>
<p><strong>Parameters:</strong> event.current_count &amp; event.uuid</p>
<p><strong>Requires:</strong> JSON API for online intake</p>
<p><strong>Returns:</strong> Nothing</p>
<p><strong>Status:</strong> In development.</p>
</section>
<section id="geting-guided-navigation-matches">
<h2>Geting Guided Navigation Matches<a class="headerlink" href="#geting-guided-navigation-matches" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is currently written in the Guided Navigation services.</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Determine which functions need to remain in which service and move them accordingly</p>
</div>
<p><strong>Function names:</strong></p>
<ul class="simple">
<li><p>get-gn-match-test (current)</p></li>
<li><p>get-gn-match (deprecated)</p></li>
</ul>
<p><strong>Purpose</strong>: Retrieves data from a specified REST API endpoint, filters and processes the data, and return a list of results (list of intake_ids) based on user input.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.token</p></li>
<li><p>event.user_issue</p></li>
<li><p>event.outcome_field (identified specific legal issue based on the answers the user provided – example: ilao-HSG-evict-guest-outcome: eviction for guests, summons, court w/in 5 days -&gt; identifies applicants who are being evicted for have guests in their apartment, they have received a summons, and they have court w/in the next 5 days)</p></li>
<li><p>event.rest_export (this value tells the system which case acceptance rest export webform to look in for matches)</p></li>
</ul>
<p><strong>Returns:</strong> intake_id values for all of the matched organizations</p>
<p><strong>Widget:</strong> get-gn-matches</p>
<p><strong>Flow:</strong> OTIS matches</p>
</section>
<section id="matches-geography">
<h2>Matches (geography)<a class="headerlink" href="#matches-geography" title="Link to this heading"></a></h2>
<p><strong>Function names:</strong></p>
<ul class="simple">
<li><p>pilot-get-matches (current)</p></li>
<li><p>pilot-get-matches-new (not yet)</p></li>
</ul>
<p><strong>Purpose:</strong> Count and respond with matched organizations based on the matched intake_id’s from the previous function against the user’s geographic area</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.zip_id</p></li>
<li><p>event.county_id</p></li>
<li><p>event.city_id</p></li>
</ul>
<p><strong>Returns:</strong> List of matched organizations</p>
<p><strong>Widget:</strong> get-otis-matches</p>
<p><strong>Flow:</strong> OTIS matches</p>
</section>
<section id="matches-names">
<h2>Matches (names)<a class="headerlink" href="#matches-names" title="Link to this heading"></a></h2>
<p><a href="#id3"><span class="problematic" id="id4">**</span></a>Function name: get-names-test</p>
<p><strong>Purpose:</strong> Gets the names of the matched organizations to provide to the applicant</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.services.split (service_id)</p></li>
<li><p>event.intakes.split (intake_id)</p></li>
</ul>
<p><strong>Returns:</strong> Names of the matched organizations</p>
<p><strong>Widget:</strong> matches-get-name</p>
<p><strong>Flow:</strong> OTIS matches</p>
</section>
<section id="get-intake-settings-data">
<h2>Get intake settings data<a class="headerlink" href="#get-intake-settings-data" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong></p>
<ul class="simple">
<li><p>get-intake-settigns-with-qualifiers (current)</p></li>
<li><p>pilot-get-intake-settings (deprecated)</p></li>
</ul>
<p><strong>Purpose:</strong> Get the intake settings for the selected organization. Also, identify if the organization uses qualifiers.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.token</p></li>
<li><p>event.intake_id</p></li>
</ul>
<p><strong>Returns:</strong> data object that contains:</p>
<ul class="simple">
<li><p>callback_number</p></li>
<li><p>callback_type</p></li>
<li><p>current_count (intake count)</p></li>
<li><p>bypass_intake_message</p></li>
<li><p>oas_msg_disclaimer</p></li>
<li><p>oas_msg_please_Call_value</p></li>
<li><p>oas_msg_we_call_you</p></li>
</ul>
<p><strong>Widget:</strong> get-intake-settings_data</p>
<p><strong>Flow:</strong> OTIS matches</p>
</section>
<section id="validate-date-functions">
<h2>Validate date functions<a class="headerlink" href="#validate-date-functions" title="Link to this heading"></a></h2>
<section id="validate-month">
<h3>Validate month<a class="headerlink" href="#validate-month" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong> otis-validate-month</p>
<p><strong>Parameters:</strong> event.month</p>
<p><strong>Returns:</strong> A variable between 0 and 13 that corresponds with the name of a month</p>
<p><strong>Widgets:</strong></p>
<ul class="simple">
<li><p>gn-date-month-return</p></li>
<li><p>validate-month</p></li>
</ul>
<p><strong>Flows:</strong></p>
<ul class="simple">
<li><p>OTIS Guided Navigation</p></li>
<li><p>OTIS Intake</p></li>
</ul>
</section>
<section id="validate-day-of-month">
<h3>Validate day of month<a class="headerlink" href="#validate-day-of-month" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong> otis-validate-day-of-month</p>
<p><strong>Parameters:</strong> event.day</p>
<p><strong>Returns:</strong> A numeric variable that has been checked against the number of possible days in the corresponding month</p>
<p><strong>Widgets:</strong></p>
<ul class="simple">
<li><p>validate-gn-date-day</p></li>
<li><p>validate-day</p></li>
</ul>
<p><strong>Flows:</strong></p>
<ul class="simple">
<li><p>OTIS Guided Navigation</p></li>
<li><p>OTIS Intake</p></li>
</ul>
</section>
<section id="validate-year">
<h3>Validate year<a class="headerlink" href="#validate-year" title="Link to this heading"></a></h3>
<p><strong>Function name:</strong> otis-validate-year</p>
<p><strong>Parameters:</strong> event.year</p>
<p><strong>Returns:</strong> A 4 digit numeric variable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the original parameter was 2 digits and those digits were greater than 10, ‘19’ is added to the parameter; if less than 11, ‘20’ is added to the beginning of the parameter to make either 1930 or 2010.</p>
</div>
<p><strong>Widgets:</strong></p>
<ul class="simple">
<li><p>validate-gn-date-year</p></li>
<li><p>validate-dob-year</p></li>
</ul>
<p><strong>Flows:</strong></p>
<ul class="simple">
<li><p>OTIS Guided Navigation</p></li>
<li><p>OTIS Intake</p></li>
</ul>
<p><strong>Requires:</strong></p>
</section>
</section>
<section id="calculate-age">
<h2>Calculate age<a class="headerlink" href="#calculate-age" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong> otis-calculate-age</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p>event.year</p></li>
<li><p>event.month</p></li>
<li><p>event.day</p></li>
</ul>
<p><strong>Purpose:</strong> Calculates the applicant’s age based on the DOB they provided when compared to the current date.</p>
<p><strong>Returns:</strong> The applicant’s age as a value. In the event of an error, it returns a null value</p>
<p><strong>Widget:</strong> calculate-age</p>
<p><strong>Flow:</strong> OTIS Intake</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>Add functions that gather race, ethnicity, gender, marital status, and income options. Each of these functions also have corresponding functions that validate them.</p>
</div>
</section>
<section id="conflict-check">
<h2>Conflict check<a class="headerlink" href="#conflict-check" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong>  otis-conflict-check</p>
<p><strong>Purpose</strong>: Queries the Legal Server conflict check API for a specific organization to evaluate whether a user has a potential conflict.</p>
<p><strong>Parameters:</strong> event.firstName, event.lastName</p>
<p><strong>Requires:</strong>  A username, password, and url for each organization we need to run a conflict check on</p>
<p><strong>Returns:</strong> An object of score (lowest, low, high, highest)</p>
</section>
<section id="send-to-legal-server">
<h2>Send to Legal Server<a class="headerlink" href="#send-to-legal-server" title="Link to this heading"></a></h2>
<p><strong>Function name:</strong>  otis-send-to-legal-server</p>
<p><strong>Purpose</strong>: Builds the data package to etransfer to LegalServer</p>
<p><strong>Parameters:</strong> event object which contains the data for the eTransfer.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Event property</p></th>
<th class="head"><p>LS property</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flow_id</p></td>
<td></td>
<td><p>Phone number the user texted to.  Used to
route between production/test environs</p></td>
</tr>
<tr class="row-odd"><td><p>flowPrefix</p></td>
<td rowspan="2"><p>externalId</p></td>
<td rowspan="2"><p>Combined in the format of flow prefix-</p>
<p>triage_id to crete a unique id</p>
</td>
</tr>
<tr class="row-even"><td><p>triage_id</p></td>
</tr>
<tr class="row-odd"><td><p>firstName</p></td>
<td><p>firstName</p></td>
<td><p>User’s first name</p></td>
</tr>
<tr class="row-even"><td><p>middleName</p></td>
<td><p>middleName</p></td>
<td><p>Not captured in SMS</p></td>
</tr>
<tr class="row-odd"><td><p>lastName</p></td>
<td><p>lastName</p></td>
<td><p>User’s last name</p></td>
</tr>
<tr class="row-even"><td><p>eTransferOrganization</p></td>
<td><p>eTransferOrganization</p></td>
<td><p>LegalServer-specific string for org.
Is stored in website LS configuration</p></td>
</tr>
<tr class="row-odd"><td><p>nickname</p></td>
<td><p>aliasFirst</p></td>
<td><p>Any entered nickname</p></td>
</tr>
<tr class="row-even"><td><p>maiden</p></td>
<td><p>aliasLast</p></td>
<td><p>Any entered maiden name</p></td>
</tr>
<tr class="row-odd"><td><p>street</p></td>
<td><p>addressHome.address1</p></td>
<td rowspan="3"><p>addressHome is an Object containing the</p>
<p>street address, city, state, zip and</p>
<p>countyFIPS code provided by the user.</p>
</td>
</tr>
<tr class="row-even"><td><p>city</p></td>
<td><p>addressHome.city</p></td>
</tr>
<tr class="row-odd"><td><p>state</p></td>
<td><p>addressHome.state</p></td>
</tr>
<tr class="row-even"><td><p>user_phone</p></td>
<td><p>phoneHome</p></td>
<td rowspan="2"><p>Either the number the user texted from or</p>
<p>a provided number, removed of any +1</p>
</td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>month</p></td>
<td><p>dateOfBirth</p></td>
<td rowspan="3"><p>Date of birth provided by user.  A 0 is</p>
<p>added for any month or day of less than</p>
<p>10</p>
</td>
</tr>
<tr class="row-odd"><td><p>day</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>year</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>email</p></td>
<td><p>email</p></td>
<td><p>User provided email addresss</p></td>
</tr>
<tr class="row-even"><td><p>maritalStatus</p></td>
<td><p>maritalStatus</p></td>
<td><p>User selected marital status</p></td>
</tr>
<tr class="row-odd"><td><p>ethnicity</p></td>
<td><p>ethicity</p></td>
<td><p>User selected ethnicity; is set to blank
if user selects prefer not to respond.</p></td>
</tr>
<tr class="row-even"><td><p>gender</p></td>
<td><p>gender</p></td>
<td><p>User selected gender.</p></td>
</tr>
<tr class="row-odd"><td><p>language</p></td>
<td><p>language</p></td>
<td><p>User selected preferred language</p></td>
</tr>
<tr class="row-even"><td><p>notes</p></td>
<td><p>notes</p></td>
<td><p>System-generated notes through triage.</p></td>
</tr>
<tr class="row-odd"><td><p>household_adults</p></td>
<td><p>numberOfAdults</p></td>
<td><p>User provided number of adults</p></td>
</tr>
<tr class="row-even"><td><p>household_children</p></td>
<td><p>numberOfChildren</p></td>
<td><p>User provided number of children</p></td>
</tr>
<tr class="row-odd"><td><p>callbackType</p></td>
<td><p>callbackType</p></td>
<td><p>Client calls or Callback</p></td>
</tr>
<tr class="row-even"><td><p>callbackDayTime</p></td>
<td><p>callbackDayTime</p></td>
<td><p>Morning or afternoon for callbacks; empty
for client calls</p></td>
</tr>
<tr class="row-odd"><td><p>income_[type]</p></td>
<td><p>income</p></td>
<td><p>income is an object that has multiple
objects for each provided income.  Each</p>
<p>item contains a type, amount, &amp; frequency</p>
</td>
</tr>
<tr class="row-even"><td><p>legalProblemCode</p></td>
<td><p>legalProblemCode</p></td>
<td><p>Legal Server problem code</p></td>
</tr>
</tbody>
</table>
<section id="flow-prefixes">
<h3>Flow prefixes<a class="headerlink" href="#flow-prefixes" title="Link to this heading"></a></h3>
<blockquote>
<div><ul class="simple">
<li><p>For eviction, this is ILAOEvict.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some translation is done on fields such as gender, race, to accommodate differences between ILAO’s taxonomy terms and Legal Server’s supported terms.</p>
</div>
</section>
<section id="incomes">
<h3>Incomes<a class="headerlink" href="#incomes" title="Link to this heading"></a></h3>
<p>The following income types are collected and supported:</p>
<ul class="simple">
<li><p>Private disability (Disability)</p></li>
<li><p>Investment income (Trust, Interest, or Dividends)</p></li>
<li><p>TANF</p></li>
<li><p>Veterans’ benefits</p></li>
<li><p>Unemployment (Unemployment Compensation)</p></li>
<li><p>SSI</p></li>
<li><p>Social Security</p></li>
<li><p>Alimony</p></li>
<li><p>Child Support</p></li>
<li><p>Workers’ Compensation</p></li>
<li><p>Pension/401K income [Pension/Retirement (Not Soc. Sec.)]</p></li>
<li><p>Other income (Other)</p></li>
<li><p>Wages/salaries (Employment)</p></li>
<li><p>Self employment (Employment)</p></li>
</ul>
<p>Except for unemployment and wages/salary, all income types have a frequency of 12 (monthly). Unemployment has a frequency of 52 (weekly).  Wages have a frequency of 12, 24, 26, or 52 depending on what the user selected.</p>
<p><strong>Requires:</strong>  API Key for LegalServer instance</p>
<p><strong>Returns:</strong> Object from Legal Server.  This object contains either an error or the global unique ID.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="otis_sms_flows.html" class="btn btn-neutral float-left" title="Flows and Subflows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="otis_global_functions.html" class="btn btn-neutral float-right" title="Global SMS functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Illinois Legal Aid Online.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>