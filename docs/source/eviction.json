{
  "description": "Eviction-en-July132021",
  "states": [
    {
      "name": "Trigger",
      "type": "trigger",
      "transitions": [
        {
          "next": "welcome",
          "event": "incomingMessage"
        },
        {
          "next": "say_play_1",
          "event": "incomingCall"
        },
        {
          "next": "first-name",
          "event": "incomingRequest"
        }
      ],
      "properties": {
        "offset": {
          "x": 330,
          "y": -600
        }
      }
    },
    {
      "name": "first-name",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "zip-code",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -530,
          "y": -240
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your first name?",
        "timeout": "3600"
      }
    },
    {
      "name": "zip-code",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-zipcode",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -510,
          "y": 240
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Hi  {{widgets.first-name.inbound.Body}}!  What is your zip code?  We need this to determine what services may be available.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-zipcode",
      "type": "run-function",
      "transitions": [
        {
          "next": "create_triage_user_init",
          "event": "success"
        },
        {
          "next": "thanks",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -590,
          "y": 490
        },
        "function_sid": "ZH66b5e454e1a5b9f7a0e91a54e4c05997",
        "parameters": [
          {
            "value": "{{widgets.zip-code.inbound.Body}}",
            "key": "zip"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-zipcode-validate"
      }
    },
    {
      "name": "in-illinois",
      "type": "send-message",
      "transitions": [
        {
          "next": "get-otis-matches",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -920,
          "y": 110
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Great! First I need to gather some information."
      }
    },
    {
      "name": "jurisdiction",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "in-illinois",
          "event": "noMatch"
        },
        {
          "next": "out-of-state",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to out-of-state",
              "arguments": [
                "{{widgets.validate-zipcode.parsed.county}}"
              ],
              "type": "is_blank",
              "value": "Is Blank"
            }
          ]
        },
        {
          "next": "show-cook-county",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to Cook",
              "arguments": [
                "{{widgets.validate-zipcode.parsed.county}}"
              ],
              "type": "equal_to",
              "value": "Cook"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-zipcode.parsed.county}}",
        "offset": {
          "x": -560,
          "y": 690
        }
      }
    },
    {
      "name": "legal-issue-start",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "legal_issue_validate",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1540,
          "y": 0
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What can I help you with?\n\n1. Stopping or preventing an eviction\n2. Getting back into my apartment after the landlord changed the locks\n3. My landlord is threatening to change the locks\n4. My landlord has shut off my lights, water, or gas or has threatened to shut them off\n5. Help paying my rent\n6. Help working things out with my landlord\n7. Another problem\n\nNot sure?  Text More for help.",
        "timeout": "3600"
      }
    },
    {
      "name": "legal-issue-split",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "legal-issue-error",
          "event": "noMatch"
        },
        {
          "next": "eviction-summons",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1, one",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "1, one"
            }
          ]
        },
        {
          "next": "set-lockout-notes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 2,two",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "2, two"
            }
          ]
        },
        {
          "next": "legal-issue-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to more",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "more"
            }
          ]
        },
        {
          "next": "get-counseling",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 3",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "5"
            }
          ]
        },
        {
          "next": "lockout-utilities",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 4",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "4"
            }
          ]
        },
        {
          "next": "update-exit-not-issue",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 7",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "7"
            }
          ]
        },
        {
          "next": "get-counseling",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 6",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "6"
            }
          ]
        },
        {
          "next": "check-bypass-1",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 3, three",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "3, three"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.legal-issue-start.inbound.Body}}",
        "offset": {
          "x": 730,
          "y": 50
        }
      }
    },
    {
      "name": "post-triage-start",
      "type": "send-message",
      "transitions": [
        {
          "next": "household-adults",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 480,
          "y": 450
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Letâ€™s start by getting information about your household."
      }
    },
    {
      "name": "household-adults",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "household-children",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 320,
          "y": 780
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How many adults live in your household? \n\nCount yourself, your spouse, and any adults not paying rent or food. \n\nDonâ€™t count your spouse if you are looking for legal help against them, or adults that pay for rent and food.",
        "timeout": "3600"
      }
    },
    {
      "name": "household-children",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "calculate-income-estimate",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -130,
          "y": 440
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How many children (under the age of 18) live in your household?  Enter 0 for none.",
        "timeout": "3600"
      }
    },
    {
      "name": "exit-to-glh",
      "type": "send-message",
      "transitions": [
        {
          "next": "final-not-otis-exit",
          "event": "sent"
        },
        {
          "next": "final-not-otis-exit",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 930,
          "y": 300
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Unfortunately, we can not complete an application over text message.  Please visit https://www.illinoislegalaid.org/get-legal-help for referrals and other help."
      }
    },
    {
      "name": "match-selected",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "match-router",
          "event": "incomingMessage"
        },
        {
          "next": "update_triage_declined",
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1430,
          "y": 620
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Iâ€™m sorry you are having an eviction issue. It looks like {{widgets.get-otis-matches.parsed.organization}}  may be able to help. To apply for help I need to get household, income, and contact information.  This will take about 5-10 minutes to complete. Would you like to continue? Text Yes or No",
        "timeout": "3600"
      }
    },
    {
      "name": "match-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "update_triage_declined",
          "event": "noMatch"
        },
        {
          "next": "set_intake_settings_variables",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Y, Yes, y, yes, true, yep, yeah, ok, okay",
              "arguments": [
                "{{widgets.match-selected.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Y, Yes, y, yes, true, yep, yeah, ok, okay, yea, Yea, Yep, Yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.match-selected.inbound.Body}}",
        "offset": {
          "x": -1720,
          "y": 900
        }
      }
    },
    {
      "name": "last-name",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "maiden-name-yes-no",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1153,
          "y": 368
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your last name?",
        "timeout": "3600"
      }
    },
    {
      "name": "thanks",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1210,
          "y": 1260
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "If you are looking for additional legal information, please visit IllinoisLegalAid.org."
      }
    },
    {
      "name": "maiden-name-yes-no",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "maiden-name-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1460,
          "y": 570
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do you have a maiden name?  Please answer Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "maiden-name-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "maiden-name-yes-no",
          "event": "noMatch"
        },
        {
          "next": "nicknames-yn",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none",
              "arguments": [
                "{{widgets.maiden-name-yes-no.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not"
            }
          ]
        },
        {
          "next": "maiden-name-input",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, Y, Yes, YES, yep, yeah",
              "arguments": [
                "{{widgets.maiden-name-yes-no.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "y, Y, Yes, YES, yep, yeah, "
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.maiden-name-yes-no.inbound.Body}}",
        "offset": {
          "x": 1090,
          "y": 940
        }
      }
    },
    {
      "name": "maiden-name-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "nicknames-yn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 560,
          "y": 1380
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your maiden name?",
        "timeout": "3600"
      }
    },
    {
      "name": "nicknames-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "nicknames-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -160,
          "y": 1532
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do you have any nicknames?  Please answer Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "nickname-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "dob-month",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -580,
          "y": 1510
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your nickname?",
        "timeout": "3600"
      }
    },
    {
      "name": "nicknames-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "nicknames-yn",
          "event": "noMatch"
        },
        {
          "next": "nickname-input",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes, y, yep, yeah, Yes, Y, YEP, YEAH",
              "arguments": [
                "{{widgets.nicknames-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "yes, y, yep, yeah, Yes, Y, YEP, YEAH"
            }
          ]
        },
        {
          "next": "dob-month",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of n, N, NO, No, no, nope, none",
              "arguments": [
                "{{widgets.nicknames-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "n, N, NO, No, no, nope, none"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.nicknames-yn.inbound.Body}}",
        "offset": {
          "x": -207,
          "y": 1825
        }
      }
    },
    {
      "name": "dob-month",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-month",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1130,
          "y": 1280
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{% assign asked = flow.variables.birthday-asked%} {% if asked %}Okay.  Let's try again {% else %}Next I need your date of birth. {% endif %}\nWhat month were you born in?",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-month",
      "type": "run-function",
      "transitions": [
        {
          "next": "process-validate-month",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1170,
          "y": 1540
        },
        "function_sid": "ZHbb14f23219de702716b81bcfb9a6f22a",
        "parameters": [
          {
            "value": "{{widgets.dob-month.inbound.Body}}",
            "key": "month"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-month"
      }
    },
    {
      "name": "process-validate-month",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "dob-day",
          "event": "noMatch"
        },
        {
          "next": "dob-month-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-month.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-month.body}}",
        "offset": {
          "x": -1152,
          "y": 1795
        }
      }
    },
    {
      "name": "dob-day",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-day",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1170,
          "y": 2070
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What day?  Please enter a number.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-day",
      "type": "run-function",
      "transitions": [
        {
          "next": "dob-day-router",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -611,
          "y": 2061
        },
        "function_sid": "ZH829dd702a3ac92671b6ebdbe54c5ce3b",
        "parameters": [
          {
            "value": "{{widgets.dob-day.inbound.Body}}",
            "key": "day"
          },
          {
            "value": "{{widgets.validate-month.body}}",
            "key": "month"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-day-of-month"
      }
    },
    {
      "name": "dob-day-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "dob-year",
          "event": "noMatch"
        },
        {
          "next": "dob-day-bad",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-day.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-day.body}}",
        "offset": {
          "x": 60,
          "y": 1070
        }
      }
    },
    {
      "name": "dob-day-bad",
      "type": "send-message",
      "transitions": [
        {
          "next": "dob-day",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1100,
          "y": 460
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "We didn't recognize that as a valid day."
      }
    },
    {
      "name": "dob-year",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-dob-year",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 700,
          "y": 2140
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What year?",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-dob-year",
      "type": "run-function",
      "transitions": [
        {
          "next": "dob-year-router",
          "event": "success"
        },
        {
          "next": "dob-year-error",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1220,
          "y": 2100
        },
        "function_sid": "ZH8ff412021bf9020177cea98024180718",
        "parameters": [
          {
            "value": "{{widgets.dob-year.inbound.Body}}",
            "key": "year"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-year"
      }
    },
    {
      "name": "dob-year-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "birthday-confirm",
          "event": "noMatch"
        },
        {
          "next": "dob-year-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-dob-year.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-dob-year.body}}",
        "offset": {
          "x": 1280,
          "y": 1690
        }
      }
    },
    {
      "name": "demo-start",
      "type": "send-message",
      "transitions": [
        {
          "next": "get-races",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 880,
          "y": -170
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "We need to collect some demographic information. The next few questions will help legal aid better serve you and your community."
      }
    },
    {
      "name": "get-races",
      "type": "run-function",
      "transitions": [
        {
          "next": "race-input",
          "event": "success"
        },
        {
          "next": "get-ethnicities",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1530,
          "y": 2220
        },
        "function_sid": "ZHc072263d9497a0c6ad5c7cb65a873c56",
        "url": "https://ilao-8092.twil.io/otis-load-races"
      }
    },
    {
      "name": "race-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-race-input",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2470,
          "y": 1280
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What best describes your race: \n\n{{widgets.get-races.parsed.body}}",
        "timeout": "3600"
      }
    },
    {
      "name": "race-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-ethnicities",
          "event": "noMatch"
        },
        {
          "next": "race-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-race-input.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        },
        {
          "next": "set-ethnicity-from-race",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 3",
              "arguments": [
                "{{widgets.validate-race-input.body}}"
              ],
              "type": "equal_to",
              "value": "Hispanic or Latino"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-race-input.body}}",
        "offset": {
          "x": 2125,
          "y": 1864
        }
      }
    },
    {
      "name": "validate-race-input",
      "type": "run-function",
      "transitions": [
        {
          "next": "race-router",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2242,
          "y": 2167
        },
        "function_sid": "ZHe1744c6fd44d9224762a73c070d55310",
        "parameters": [
          {
            "value": "{{widgets.race-input.inbound.Body}}",
            "key": "race"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-race"
      }
    },
    {
      "name": "ethnicity-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-ethnicity-input",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -970,
          "y": 2460
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What best describes your ethnicity?\n\n{{widgets.get-ethnicities.parsed.body}}",
        "timeout": "3600"
      }
    },
    {
      "name": "get-ethnicities",
      "type": "run-function",
      "transitions": [
        {
          "next": "ethnicity-input",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -460,
          "y": 2430
        },
        "function_sid": "ZH94cc982cde5924719d6264596511c7c2",
        "url": "https://ilao-8092.twil.io/otis-load-ethnicity"
      }
    },
    {
      "name": "validate-ethnicity-input",
      "type": "run-function",
      "transitions": [
        {
          "next": "ethnicity-router",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -950,
          "y": 2750
        },
        "function_sid": "ZH37aaef7728e8369142653def8b1586d4",
        "parameters": [
          {
            "value": "{{widgets.ethnicity-input.inbound.Body}}",
            "key": "ethnicity"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-ethnicity"
      }
    },
    {
      "name": "ethnicity-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "set_ethnicity",
          "event": "noMatch"
        },
        {
          "next": "ethnicity-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-ethnicity-input.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-ethnicity-input.body}}",
        "offset": {
          "x": -323,
          "y": 2708
        }
      }
    },
    {
      "name": "income-intro",
      "type": "send-message",
      "transitions": [
        {
          "next": "income-wages-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 400,
          "y": 2545
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Thank you.  Legal aid programs have income limits for who they can help.  We need to collect income information to determine eligibility."
      }
    },
    {
      "name": "income-wages-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "wages-yn-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 910,
          "y": 2540
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do you have wages or salary from a job (not self-employment)?  Type Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "wages-yn-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "income-wages-yn",
          "event": "noMatch"
        },
        {
          "next": "self-employment-yn",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not",
              "arguments": [
                "{{widgets.income-wages-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not"
            }
          ]
        },
        {
          "next": "wages-frequency",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah",
              "arguments": [
                "{{widgets.income-wages-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah, wages, Wages, Wage, wage, salary, Salary, salaries, Salaries"
            }
          ]
        },
        {
          "next": "income-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to Not sure",
              "arguments": [
                "{{widgets.income-wages-yn.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "Not sure"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.income-wages-yn.inbound.Body}}",
        "offset": {
          "x": -430,
          "y": 2860
        }
      }
    },
    {
      "name": "wages-collect",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-wages",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1430,
          "y": 2700
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you earn per pay period?  You should include the total amount of money, or gross income, before any taxes are taken out of your pay.\n\nPlease enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-wages",
      "type": "run-function",
      "transitions": [
        {
          "next": "wages-router",
          "event": "success"
        },
        {
          "next": "wages-collect",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1240,
          "y": 2350
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.wages-collect.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "wages-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "self-employment-yn",
          "event": "noMatch"
        },
        {
          "next": "wages-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-wages.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        },
        {
          "next": "wages-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "validate-wages.body",
              "arguments": [
                "{{widgets.validate-wages.body}}"
              ],
              "type": "is_blank",
              "value": "Is Blank"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-wages.body}}",
        "offset": {
          "x": 1860,
          "y": 2720
        }
      }
    },
    {
      "name": "self-employment-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "self-employ-yn-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2152,
          "y": 2431
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do you have any self-employment or farming income? Type Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "self-employ-yn-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "self-employ-help",
          "event": "noMatch"
        },
        {
          "next": "benefits-yn",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not",
              "arguments": [
                "{{widgets.self-employment-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not"
            }
          ]
        },
        {
          "next": "self-employ-collect",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah, wages, Wages, Wage, wage, salary, Salary, salaries, Salaries",
              "arguments": [
                "{{widgets.self-employment-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah, wages, Wages, Wage, wage, salary, Salary, salaries, Salaries"
            }
          ]
        },
        {
          "next": "self-employ-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to Not sure",
              "arguments": [
                "{{widgets.self-employment-yn.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "Not sure"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.self-employment-yn.inbound.Body}}",
        "offset": {
          "x": 2290,
          "y": 2660
        }
      }
    },
    {
      "name": "self-employ-collect",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-self-employ",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2882,
          "y": 1998
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "On average, how much do you make in a month?  You should look at your most recent tax return and divide the adjusted gross income by 12.\n\nPlease enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-self-employ",
      "type": "run-function",
      "transitions": [
        {
          "next": "self-employ-router",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2793,
          "y": 1105
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.self-employ-collect.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "self-employ-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-yn",
          "event": "noMatch"
        },
        {
          "next": "self-employ-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-self-employ.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-self-employ.body}}",
        "offset": {
          "x": 2800,
          "y": 430
        }
      }
    },
    {
      "name": "benefits-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "benefits-yn-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2110,
          "y": 901
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{% assign asked = flow.variables.benefits-asked%} {% if asked %}Okay.  Which of these do you receive? {% else %}Do you receive any of the following government benefits? Reply Yes or No: {% endif %}\n1. TANF\n2. Veterans Benefits (including disability) \n3. Unemployment,\n4. SSI\n5. Social security (retirement or disability)\n{% assign asked = flow.variables.benefits-asked%} {% if asked %}Enter the numbers of the ones you receive.{% endif %}",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-benefits-types",
      "type": "run-function",
      "transitions": [
        {
          "next": "benefits-route-1",
          "event": "success"
        },
        {
          "next": "benefits-route-1",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2060,
          "y": 400
        },
        "function_sid": "ZHe5e18d13603f2b9aa0ce863758c7067f",
        "parameters": [
          {
            "value": "{{widgets.benefits-yn.inbound.Body}}",
            "key": "benefits"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-benefits-types"
      }
    },
    {
      "name": "benefits-yn-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "validate-benefits-types",
          "event": "noMatch"
        },
        {
          "next": "other-payments-yn",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not",
              "arguments": [
                "{{widgets.benefits-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        },
        {
          "next": "benefits-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of &",
              "arguments": [
                "{{widgets.benefits-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "&, Not sure, I don't know, don't know"
            }
          ]
        },
        {
          "next": "set-benefit-asked",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah",
              "arguments": [
                "{{widgets.benefits-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.benefits-yn.inbound.Body}}",
        "offset": {
          "x": 2900,
          "y": 830
        }
      }
    },
    {
      "name": "benefits-route-1",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-2",
          "event": "noMatch"
        },
        {
          "next": "get-tanf-amount",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 1",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "contains",
              "value": "\"1\""
            }
          ]
        },
        {
          "next": "benefits-route-2",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not"
            }
          ]
        },
        {
          "next": "benefits-yn-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "equal_to",
              "value": "[]"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-benefits-types.body}}",
        "offset": {
          "x": 2050,
          "y": 120
        }
      }
    },
    {
      "name": "benefits-route-2",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-3",
          "event": "noMatch"
        },
        {
          "next": "get-veterans-amount",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 2",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "contains",
              "value": "\"2\""
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-benefits-types.body}}",
        "offset": {
          "x": 1350,
          "y": 390
        }
      }
    },
    {
      "name": "get-tanf-amount",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-tanf",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2500,
          "y": 0
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much is your TANF (cash) benefit per month? Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-tanf",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-tanf",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3620,
          "y": -170
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-tanf-amount.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-tanf",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-2",
          "event": "noMatch"
        },
        {
          "next": "get-tanf-amount",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-tanf.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-tanf.body}}",
        "offset": {
          "x": 3031,
          "y": 236
        }
      }
    },
    {
      "name": "get-veterans-amount",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-va-benefits",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3410,
          "y": 530
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much are your Veterans Benefits per month?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-va-benefits",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-va-benefits",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3565,
          "y": 172
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-veterans-amount.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-va-benefits",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-3",
          "event": "noMatch"
        },
        {
          "next": "get-veterans-amount",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-va-benefits.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-va-benefits.body}}",
        "offset": {
          "x": 3700,
          "y": 421
        }
      }
    },
    {
      "name": "benefits-route-3",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-4",
          "event": "noMatch"
        },
        {
          "next": "get-unemployment",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 3",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "contains",
              "value": "3"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-benefits-types.body}}",
        "offset": {
          "x": 3712,
          "y": 770
        }
      }
    },
    {
      "name": "get-unemployment",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-unemployment",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3970,
          "y": 30
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you receive each week in unemployment benefits? Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-unemployment",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-unemployments",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4010,
          "y": 260
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-unemployment.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-unemployments",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-4",
          "event": "noMatch"
        },
        {
          "next": "get-unemployment",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-unemployment.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-unemployment.body}}",
        "offset": {
          "x": 4079,
          "y": 545
        }
      }
    },
    {
      "name": "benefits-route-4",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-5",
          "event": "noMatch"
        },
        {
          "next": "get-SSI",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 4",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "contains",
              "value": "4"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-benefits-types.body}}",
        "offset": {
          "x": 4090,
          "y": 810
        }
      }
    },
    {
      "name": "get-SSI",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-ssi",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3969,
          "y": 1067
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much in SSI benefits do you get each month?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-ssi",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-SSI",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3630,
          "y": 1070
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-SSI.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-SSI",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "benefits-route-5",
          "event": "noMatch"
        },
        {
          "next": "get-SSI",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-ssi.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-ssi.body}}",
        "offset": {
          "x": 3270,
          "y": 1280
        }
      }
    },
    {
      "name": "benefits-route-5",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "other-payments-yn",
          "event": "noMatch"
        },
        {
          "next": "get-social-security",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 5",
              "arguments": [
                "{{widgets.validate-benefits-types.body}}"
              ],
              "type": "contains",
              "value": "5"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-benefits-types.body}}",
        "offset": {
          "x": 3710,
          "y": 1620
        }
      }
    },
    {
      "name": "get-social-security",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-social-security",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4093,
          "y": 1348
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you receive in social security (retirement or disability) each month?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-social-security",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-end-benefits",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4090,
          "y": 1560
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-social-security.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-end-benefits",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "other-payments-yn",
          "event": "noMatch"
        },
        {
          "next": "get-social-security",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-social-security.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-social-security.body}}",
        "offset": {
          "x": 4096,
          "y": 1748
        }
      }
    },
    {
      "name": "other-payments-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-payments-YN",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4564,
          "y": -193
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{% assign asked = flow.variables.other-payments-asked%} {% if asked %}Okay.  Which of these do you receive? {% else %} \nDo you have any of these on a regular basis? Reply Yes or No:{% endif %}\n1. Private insurance disability payments\n2. Alimony or spousal support\n3. Child support\n4. Workers compensation\n5. Income from a pension or 401K\n6. Investment income\n{% assign asked = flow.variables.other-payments-asked%} {% if asked %}Enter the numbers of the ones you receive.{% endif %}",
        "timeout": "3600"
      }
    },
    {
      "name": "route-payments-YN",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "validate-payments",
          "event": "noMatch"
        },
        {
          "next": "get-other-income-yn",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not",
              "arguments": [
                "{{widgets.other-payments-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        },
        {
          "next": "payments-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Not sure, I don't know, Don't know",
              "arguments": [
                "{{widgets.other-payments-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Not sure, I don't know, Don't know"
            }
          ]
        },
        {
          "next": "set_other_payments_asked",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of  y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah",
              "arguments": [
                "{{widgets.other-payments-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": " y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.other-payments-yn.inbound.Body}}",
        "offset": {
          "x": 4580,
          "y": 100
        }
      }
    },
    {
      "name": "validate-payments",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-payments-1",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4720,
          "y": 360
        },
        "function_sid": "ZHb6d14e847a49367b8d3ef9f8f399c092",
        "parameters": [
          {
            "value": "{{widgets.other-payments-yn.inbound.Body}}",
            "key": "payments"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-payments"
      }
    },
    {
      "name": "route-payments-1",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-2",
          "event": "noMatch"
        },
        {
          "next": "get-private-disability",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 1",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "1"
            }
          ]
        },
        {
          "next": "payments-yn-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to []",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "equal_to",
              "value": "[]"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 4930,
          "y": 400
        }
      }
    },
    {
      "name": "get-private-disability",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-private-disability",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4674,
          "y": 891
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much in private insurance disability payments do you receive each month?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-private-disability",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-private-disability",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4537,
          "y": 1189
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-private-disability.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-private-disability",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-2",
          "event": "noMatch"
        },
        {
          "next": "get-private-disability",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-private-disability.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-private-disability.body}}",
        "offset": {
          "x": 4638,
          "y": 1441
        }
      }
    },
    {
      "name": "route-payments-2",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-3",
          "event": "noMatch"
        },
        {
          "next": "get-alimony",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 2",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "2"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 4897,
          "y": 1146
        }
      }
    },
    {
      "name": "get-alimony",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-alimony",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5326,
          "y": -149
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you get in alimony each month? Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-alimony",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-alimony",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 5360,
          "y": 100
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-alimony.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-alimony",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-3",
          "event": "noMatch"
        },
        {
          "next": "get-alimony",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-alimony.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-alimony.body}}",
        "offset": {
          "x": 5319,
          "y": 338
        }
      }
    },
    {
      "name": "route-payments-3",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-4",
          "event": "noMatch"
        },
        {
          "next": "get-child-support",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 3",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "3"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 5286,
          "y": 626
        }
      }
    },
    {
      "name": "get-child-support",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-child-support",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5290,
          "y": 848
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you get each month in child support?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-child-support",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-child-support",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 5316,
          "y": 1126
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-child-support.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-child-support",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-4",
          "event": "noMatch"
        },
        {
          "next": "get-child-support",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-child-support.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-child-support.body}}",
        "offset": {
          "x": 5174,
          "y": 1368
        }
      }
    },
    {
      "name": "route-payments-4",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-5",
          "event": "noMatch"
        },
        {
          "next": "get-workers-comp",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 4",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "4"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 5047,
          "y": 1628
        }
      }
    },
    {
      "name": "get-workers-comp",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-workers-comp",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 6070,
          "y": -320
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you get each month in workers compensation?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-workers-comp",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-workers-comp",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 5710,
          "y": 410
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-workers-comp.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-workers-comp",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-5",
          "event": "noMatch"
        },
        {
          "next": "get-workers-comp",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-workers-comp.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-workers-comp.body}}",
        "offset": {
          "x": 5770,
          "y": 670
        }
      }
    },
    {
      "name": "route-payments-5",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-6",
          "event": "noMatch"
        },
        {
          "next": "get-retirement",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 5",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "5"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 5770,
          "y": 920
        }
      }
    },
    {
      "name": "get-retirement",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-retirement",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5910,
          "y": 1220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you receive per month in retirement income (pension or 401K)? Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-retirement",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-retirement",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 5845,
          "y": 1441
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-retirement.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-retirement",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "route-payments-6",
          "event": "noMatch"
        },
        {
          "next": "get-retirement",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-retirement.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-retirement.body}}",
        "offset": {
          "x": 5820,
          "y": 1700
        }
      }
    },
    {
      "name": "route-payments-6",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-other-income-yn",
          "event": "noMatch"
        },
        {
          "next": "get-investement-income",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains 6",
              "arguments": [
                "{{widgets.validate-payments.body}}"
              ],
              "type": "contains",
              "value": "6"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-payments.body}}",
        "offset": {
          "x": 5540,
          "y": 1960
        }
      }
    },
    {
      "name": "get-investement-income",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-investment",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5200,
          "y": 1920
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you receive per month in investment income?  Please enter only numbers.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-investment",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-investment-income",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 5142,
          "y": 2201
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-investement-income.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-investment-income",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-other-income-yn",
          "event": "noMatch"
        },
        {
          "next": "get-investement-income",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-investment.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-investment.body}}",
        "offset": {
          "x": 4660,
          "y": 2030
        }
      }
    },
    {
      "name": "get-other-income-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-other-income-yn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4220,
          "y": 2000
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do you have any other income?  For example, any money you get from a friend or relative to help pay your bills. Please answer Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-other-income-yn",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-other-income",
          "event": "noMatch"
        },
        {
          "next": "validate-income-level",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, yes, Y, YES, yep, yeah, Yep, Yeah",
              "arguments": [
                "{{widgets.get-other-income-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no,nope,n,N,No,Nope,not,Not"
            }
          ]
        },
        {
          "next": "other-income-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Not sure, I don't know, don't know, maybe",
              "arguments": [
                "{{widgets.get-other-income-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Not sure, I don't know, don't know, maybe"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-other-income-yn.inbound.Body}}",
        "offset": {
          "x": 3600,
          "y": 1930
        }
      }
    },
    {
      "name": "get-other-income",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-other-income",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3550,
          "y": 2360
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How much do you receive each month in other income? Please enter only numbers. Enter 0 if you do not receive any other income.",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-other-income",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-other-income",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4050,
          "y": 2540
        },
        "function_sid": "ZHbaf6e7533d2a9a4c890b74440534db19",
        "parameters": [
          {
            "value": "{{widgets.get-other-income.inbound.Body}}",
            "key": "amount"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-money-input"
      }
    },
    {
      "name": "route-other-income",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "validate-income-level",
          "event": "noMatch"
        },
        {
          "next": "get-other-income",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.validate-other-income.body}}"
              ],
              "type": "equal_to",
              "value": "-1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-other-income.body}}",
        "offset": {
          "x": 4130,
          "y": 2810
        }
      }
    },
    {
      "name": "contact-number-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-contact-number-yn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4870,
          "y": 2530
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Next we need your contact information.  Is this the best number to reach you?",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-income-level",
      "type": "run-function",
      "transitions": [
        {
          "next": "set-total-income",
          "event": "success"
        },
        {
          "next": "set-total-income",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3520,
          "y": 2930
        },
        "function_sid": "ZH07152a43bfe672c29e2d840d94437217",
        "parameters": [
          {
            "value": "{{widgets.get-private-disability.inbound.Body}}",
            "key": "income_private_disability"
          },
          {
            "value": "{{widgets.get-investement-income.inbound.Body}}",
            "key": "income_investments"
          },
          {
            "value": "{{widgets.get-tanf-amount.inbound.Body}}",
            "key": "income_tanf"
          },
          {
            "value": "{{widgets.get-veterans-amount.inbound.Body}}",
            "key": "income_veterans_amount"
          },
          {
            "value": "{{widgets.get-unemployment.inbound.Body}}",
            "key": "income_unemployment"
          },
          {
            "value": "{{widgets.get-SSI.inbound.Body}}",
            "key": "income_ssi"
          },
          {
            "value": "{{widgets.get-social-security.inbound.Body}}",
            "key": "income_social_security"
          },
          {
            "value": "{{widgets.get-alimony.inbound.Body}}",
            "key": "income_alimony"
          },
          {
            "value": "{{widgets.get-child-support.inbound.Body}}",
            "key": "income_child_support"
          },
          {
            "value": "{{widgets.get-workers-comp.inbound.Body}}",
            "key": "income_workers_comp"
          },
          {
            "value": "{{widgets.get-retirement.inbound.Body}}",
            "key": "income_pension"
          },
          {
            "value": "{{widgets.get-investement-income.inbound.Body}}",
            "key": "income_investments"
          },
          {
            "value": "{{widgets.get-other-income.inbound.Body}}",
            "key": "income_other_income"
          },
          {
            "value": "{{widgets.wages-collect.inbound.Body}}",
            "key": "income_wages"
          },
          {
            "value": "{{widgets.self-employ-collect.inbound.Body}}",
            "key": "income_self_employment"
          },
          {
            "value": "{{widgets.household-adults.inbound.Body}}",
            "key": "adults"
          },
          {
            "value": "{{widgets.household-children.inbound.Body}}",
            "key": "children"
          },
          {
            "value": "ami",
            "key": "standard"
          },
          {
            "value": "80",
            "key": "max"
          },
          {
            "value": "{{widgets.wages-frequency.inbound.Body}}",
            "key": "wage_frequency"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-total-income"
      }
    },
    {
      "name": "route-income-resources",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "contact-number-yn",
          "event": "noMatch"
        },
        {
          "next": "overincome-message",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1",
              "arguments": [
                "{{widgets.validate-income-level.parsed.incomeFlag}}"
              ],
              "type": "equal_to",
              "value": "1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-income-level.parsed.incomeFlag}}",
        "offset": {
          "x": 4000,
          "y": 3090
        }
      }
    },
    {
      "name": "route-contact-number-yn",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "set_trigger_phone",
          "event": "noMatch"
        },
        {
          "next": "get-best-number",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of No, no, n, N, nope, not",
              "arguments": [
                "{{widgets.contact-number-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "No, no, n, N, nope, not"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.contact-number-yn.inbound.Body}}",
        "offset": {
          "x": 4720,
          "y": 2770
        }
      }
    },
    {
      "name": "get-best-number",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-phone",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4800,
          "y": 3850
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{% assign asked = flow.variables.asked-phone%} {% if asked %}Okay.  Let's try again. {% endif %}\nWhat is the best number to contact you? Please enter a 10 digit number only.  If you have an extension, add x followed by the extension (for example 1234567890x123)",
        "timeout": "3600"
      }
    },
    {
      "name": "get-email-address",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "get-street-address",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5310,
          "y": 3040
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your email address?  Please only provide an email if it is safe for us to contact you.  Reply None if you do not have a safe email.",
        "timeout": "3600"
      }
    },
    {
      "name": "get-street-address",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "get-city",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 5123,
          "y": 3418
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your street address?",
        "timeout": "3600"
      }
    },
    {
      "name": "get-city",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "confirm-address-yn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4340,
          "y": 3410
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is your city?",
        "timeout": "3600"
      }
    },
    {
      "name": "route-contact-type",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "show-please-call-confirm",
          "event": "noMatch"
        },
        {
          "next": "ask-callback-preference",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1",
              "arguments": [
                "{{flow.variables.callback_type}}"
              ],
              "type": "equal_to",
              "value": "we_call_client"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.variables.callback_type}}",
        "offset": {
          "x": 3180,
          "y": 3380
        }
      }
    },
    {
      "name": "get-first-callback-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-first-callback",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2275,
          "y": 3301
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Legal Aid Chicago needs to schedule a callback time.  {{widgets.get-first-callback-time.parsed.intro}}. {{widgets.get-first-callback-time.parsed.first}} Will that day work for you? Please answer Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "get-first-callback-time",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-first-callback-yn",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2708,
          "y": 3355
        },
        "function_sid": "ZHa24ff086caff4aa7ccb49a252f7f1554",
        "url": "https://ilao-8092.twil.io/otis-get-first-callback-time"
      }
    },
    {
      "name": "route-first-callback",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-next-dates",
          "event": "noMatch"
        },
        {
          "next": "get-callback-times-for-first-date",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Yes, Y, YES, y, yep, yeah",
              "arguments": [
                "{{widgets.get-first-callback-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Yes, Y, YES, y, yep, yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-first-callback-yn.inbound.Body}}",
        "offset": {
          "x": 1930,
          "y": 3580
        }
      }
    },
    {
      "name": "get-callback-times-for-first-date",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-available-date-choice",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1510,
          "y": 3730
        },
        "function_sid": "ZH60ad95996c9bebadac2bacbb02a358dd",
        "parameters": [
          {
            "value": "{{widgets.get-first-callback-time.parsed.callback-date}}",
            "key": "callbackDate"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-get-callback-times"
      }
    },
    {
      "name": "get-available-date-choice",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "send-to-legal-server",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2030,
          "y": 3910
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Schedule a time for your call. The program may call you anytime in that hour.\n\n{{widgets.get-callback-times-for-first-date.parsed.times}}",
        "timeout": "3600"
      }
    },
    {
      "name": "get-next-dates",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-best-date",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2723,
          "y": 3681
        },
        "function_sid": "ZH671e0e232a896bf7a016a558494adc2d",
        "url": "https://ilao-8092.twil.io/otis-get-callback-days"
      }
    },
    {
      "name": "get-best-date",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-callback-date-advanced",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2533,
          "y": 4001
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "These are the next available dates.  Please select the best.  Text 0 if none of these will work for you.  \n\n{{widgets.get-next-dates.parsed.days}}",
        "timeout": "3600"
      }
    },
    {
      "name": "get-callback-times-for-choice",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-callback-time-best",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3030,
          "y": 4060
        },
        "function_sid": "ZH60ad95996c9bebadac2bacbb02a358dd",
        "parameters": [
          {
            "value": "{{widgets.get-best-date.inbound.Body}}",
            "key": "callbackDate"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-get-callback-times"
      }
    },
    {
      "name": "route-callback-date-advanced",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-callback-times-for-choice",
          "event": "noMatch"
        },
        {
          "next": "thanks",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 0",
              "arguments": [
                "{{widgets.get-best-date.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-best-date.inbound.Body}}",
        "offset": {
          "x": 2517,
          "y": 4318
        }
      }
    },
    {
      "name": "get-callback-time-best",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "send-to-legal-server",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3270,
          "y": 4350
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What time?  The program may call you anytime in that hour.\n{{widgets.get-callback-times-for-choice.parsed.times}}",
        "timeout": "3600"
      }
    },
    {
      "name": "send-to-legal-server",
      "type": "run-function",
      "transitions": [
        {
          "next": "legal-server-error-handling",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3260,
          "y": 4720
        },
        "function_sid": "ZH70374f4ebe18dc72624af0bf9da089af",
        "parameters": [
          {
            "value": "{{widgets.get-private-disability.inbound.Body}}",
            "key": "income_private_disability"
          },
          {
            "value": "{{widgets.get-investement-income.inbound.Body}}",
            "key": "income_investments"
          },
          {
            "value": "{{widgets.get-tanf-amount.inbound.Body}}",
            "key": "income_tanf"
          },
          {
            "value": "{{widgets.get-veterans-amount.inbound.Body}}",
            "key": "income_veterans_amount"
          },
          {
            "value": "{{widgets.get-unemployment.inbound.Body}}",
            "key": "income_unemployment"
          },
          {
            "value": "{{widgets.get-SSI.inbound.Body}}",
            "key": "income_ssi"
          },
          {
            "value": "{{widgets.get-social-security.inbound.Body}}",
            "key": "income_social_security"
          },
          {
            "value": "{{widgets.get-alimony.inbound.Body}}",
            "key": "income_alimony"
          },
          {
            "value": "{{widgets.get-child-support.inbound.Body}}",
            "key": "income_child_support"
          },
          {
            "value": "{{widgets.get-workers-comp.inbound.Body}}",
            "key": "income_workers_comp"
          },
          {
            "value": "{{widgets.get-retirement.inbound.Body}}",
            "key": "income_pension"
          },
          {
            "value": "{{widgets.get-investement-income.inbound.Body}}",
            "key": "income_investments"
          },
          {
            "value": "{{widgets.get-other-income.inbound.Body}}",
            "key": "income_other_income"
          },
          {
            "value": "{{widgets.wages-collect.inbound.Body}}",
            "key": "income_wages"
          },
          {
            "value": "{{widgets.self-employ-collect.inbound.Body}}",
            "key": "income_self_employment"
          },
          {
            "value": "{{flow.variables.frequency}}",
            "key": "wage_frequency"
          },
          {
            "value": "{{widgets.first-name.inbound.Body}}",
            "key": "firstName"
          },
          {
            "value": "{{widgets.last-name.inbound.Body}}",
            "key": "lastName"
          },
          {
            "value": "{{flow.variables.legalservername}}",
            "key": "eTransferOrganization"
          },
          {
            "value": "{{flow.variables.callbackType}}",
            "key": "callbackType"
          },
          {
            "value": "{{widgets.validate-race-input.body}}",
            "key": "race"
          },
          {
            "value": "{{flow.variables.ethnicity}}",
            "key": "ethnicity"
          },
          {
            "value": "{{widgets.validate-gender.body}}",
            "key": "gender"
          },
          {
            "value": "{{widgets.validate-preferred-language.body}}",
            "key": "language"
          },
          {
            "value": "{{widgets.validate-marital-status.body}}",
            "key": "maritalStatus"
          },
          {
            "value": "{{widgets.nickname-input.inbound.Body}}",
            "key": "aliasFirst"
          },
          {
            "value": "{{widgets.maiden-name-input.inbound.Body}}",
            "key": "aliasLast"
          },
          {
            "value": "{{flow.variables.user_phone}}",
            "key": "user_phone"
          },
          {
            "value": "{{widgets.get-email-address.inbound.Body}}",
            "key": "email"
          },
          {
            "value": "{{widgets.get-street-address.inbound.Body}}",
            "key": "street"
          },
          {
            "value": "{{widgets.get-city.inbound.Body}}",
            "key": "city"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.state}}",
            "key": "state"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.zip_code}}",
            "key": "zip"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.fips}}",
            "key": "countyFips"
          },
          {
            "value": "{{flow.variables.notes}}",
            "key": "notes"
          },
          {
            "value": "{{widgets.validate-day.body}}",
            "key": "day"
          },
          {
            "value": "{{widgets.validate-month.body}}",
            "key": "month"
          },
          {
            "value": "{{widgets.validate-dob-year.body}}",
            "key": "year"
          },
          {
            "value": "{{widgets.household-adults.inbound.Body}}",
            "key": "household_adults"
          },
          {
            "value": "{{widgets.household-children.inbound.Body}}",
            "key": "household_children"
          },
          {
            "value": "{{widgets.ask-callback-preference.inbound.Body}}",
            "key": "callbackDayTime"
          },
          {
            "value": "63 Landlord/ Tenant (Not Public Housing)",
            "key": "legalProblemCode"
          },
          {
            "value": "ILAOEvict",
            "key": "flowPrefix"
          },
          {
            "value": "{{flow.variables.triage_id}}",
            "key": "triage_id"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-send-to-legal-server"
      }
    },
    {
      "name": "out-of-state",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "zip-code",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1140,
          "y": -360
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Sorry, this application can only be used for legal issues in Illinois.  For local resources please visit https://www.lawhelp.org.\n\nTo enter a new zip, text zip",
        "timeout": "3600"
      }
    },
    {
      "name": "route-household-values",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "set_household_size",
          "event": "noMatch"
        },
        {
          "next": "household-size-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to error",
              "arguments": [
                "{{widgets.calculate-income-estimate.parsed.household_size}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.calculate-income-estimate.parsed.household_size}}",
        "offset": {
          "x": -2010,
          "y": 1210
        }
      }
    },
    {
      "name": "household-size-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "household-adults",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -2004,
          "y": 1495
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "One or more of the values entered is not a valid number.  Please try again."
      }
    },
    {
      "name": "get-genders",
      "type": "run-function",
      "transitions": [
        {
          "next": "gender-input",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -428,
          "y": 3045
        },
        "function_sid": "ZHa8e1506133e6b50338cef56330856c83",
        "url": "https://ilao-8092.twil.io/otis-load-genders"
      }
    },
    {
      "name": "gender-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-gender",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -510,
          "y": 3280
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What best describes your gender?\n\n{{widgets.get-genders.parsed.body}}",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-gender",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-gender",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1118,
          "y": 3658
        },
        "function_sid": "ZH8b85b839e84106768669075fb551e77e",
        "parameters": [
          {
            "value": "{{widgets.gender-input.inbound.Body}}",
            "key": "gender"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-gender"
      }
    },
    {
      "name": "route-gender",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-marital-statuses",
          "event": "noMatch"
        },
        {
          "next": "gender-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to error",
              "arguments": [
                "{{widgets.validate-gender.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-gender.body}}",
        "offset": {
          "x": -1750,
          "y": 3440
        }
      }
    },
    {
      "name": "gender-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "gender-input",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1728,
          "y": 3138
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please enter a number from the list of options."
      }
    },
    {
      "name": "get-marital-statuses",
      "type": "run-function",
      "transitions": [
        {
          "next": "marital-status-input",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1961,
          "y": 3918
        },
        "function_sid": "ZHa0d0a77fded07269ee82c8c727fa1885",
        "url": "https://ilao-8092.twil.io/otis-load-marital-statuses"
      }
    },
    {
      "name": "marital-status-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-marital-status",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1560,
          "y": 3910
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What best describes your marital status?\n\n{{widgets.get-marital-statuses.parsed.body}}",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-marital-status",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-marital-status",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1210,
          "y": 3930
        },
        "function_sid": "ZH1cf654468ce472f03395a1280a4d7700",
        "parameters": [
          {
            "value": "{{widgets.marital-status-input.inbound.Body}}",
            "key": "maritalStatus"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-marital-status"
      }
    },
    {
      "name": "route-marital-status",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "get-preferred-languages",
          "event": "noMatch"
        },
        {
          "next": "marital-status-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to error",
              "arguments": [
                "{{widgets.validate-marital-status.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-marital-status.body}}",
        "offset": {
          "x": -830,
          "y": 3910
        }
      }
    },
    {
      "name": "marital-status-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "marital-status-input",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -528,
          "y": 3591
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please make a valid selection."
      }
    },
    {
      "name": "get-preferred-languages",
      "type": "run-function",
      "transitions": [
        {
          "next": "preferred-language-input",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 30,
          "y": 3120
        },
        "function_sid": "ZHcd86bab8124a1d7f52ef9abe22b44deb",
        "url": "https://ilao-8092.twil.io/otis-load-languages"
      }
    },
    {
      "name": "preferred-language-input",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "validate-preferred-language",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 21,
          "y": 3401
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What language do you prefer to communicate in? \n\n{{widgets.get-preferred-languages.parsed.body}}",
        "timeout": "3600"
      }
    },
    {
      "name": "validate-preferred-language",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-preferred-language",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1,
          "y": 3641
        },
        "function_sid": "ZH1bd7ae241b23cf1005a7d8af8676e1cf",
        "parameters": [
          {
            "value": "{{widgets.preferred-language-input.inbound.Body}}",
            "key": "language"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-validate-preferred-language"
      }
    },
    {
      "name": "route-preferred-language",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "update-triage-demo",
          "event": "noMatch"
        },
        {
          "next": "language-error",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to error",
              "arguments": [
                "{{widgets.validate-preferred-language.body}}"
              ],
              "type": "equal_to",
              "value": "0"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.validate-preferred-language.body}}",
        "offset": {
          "x": -60,
          "y": 3870
        }
      }
    },
    {
      "name": "race-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "race-input",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2668,
          "y": 1651
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply with a number that matches the list of options."
      }
    },
    {
      "name": "language-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "preferred-language-input",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 452,
          "y": 3258
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply with a number from the list of languages."
      }
    },
    {
      "name": "income-help",
      "type": "send-message",
      "transitions": [
        {
          "next": "income-wages-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 831,
          "y": 3175
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Wages or salary is the amount of money that a person is paid for work they do by an employer."
      }
    },
    {
      "name": "self-employ-help",
      "type": "send-message",
      "transitions": [
        {
          "next": "self-employment-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2289,
          "y": 2947
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Self-employment includes income from running your own business, contract work, and gig work such as driving for Uber or delivering for Instacart.  Take the average amount you earned for the year and divide by 12."
      }
    },
    {
      "name": "get-otis-matches",
      "type": "run-function",
      "transitions": [
        {
          "next": "matches-returned-router",
          "event": "success"
        },
        {
          "next": "update-exit-not-issue",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1200,
          "y": 460
        },
        "function_sid": "ZHf8fd55408e30d123f0d7d047f48f19e2",
        "parameters": [
          {
            "value": "{{widgets.zip-code.inbound.Body}}",
            "key": "zip"
          },
          {
            "value": "{{widgets.legal-issue-start.inbound.Body}}",
            "key": "issue"
          },
          {
            "value": "{{flow.variables.county_id}}",
            "key": "county_id"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/eviction-intake-settings"
      }
    },
    {
      "name": "exit-with-information",
      "type": "send-message",
      "transitions": [
        {
          "next": "final-not-otis-exit",
          "event": "sent"
        },
        {
          "next": "final-not-otis-exit",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -2250,
          "y": 490
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{widgets.get-content.body}}"
      }
    },
    {
      "name": "create_triage_user_init",
      "type": "run-function",
      "transitions": [
        {
          "next": "set_triage_init_data",
          "event": "success"
        },
        {
          "next": "final-not-otis-exit",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2540,
          "y": -620
        },
        "function_sid": "ZHe1947715a825416ef5ea4d2ffdeeab0c",
        "parameters": [
          {
            "value": "{{widgets.validate-zipcode.parsed.zip_code}}",
            "key": "zip_code"
          },
          {
            "value": "eviction-english",
            "key": "source"
          },
          {
            "value": "sms-zip-code",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{trigger.message.From}}",
            "key": "user_phone"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.county}}",
            "key": "county"
          },
          {
            "value": "{{trigger.message.Body}}",
            "key": "search"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-create-triage-user"
      }
    },
    {
      "name": "final-not-otis-exit",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -3100,
          "y": 1030
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "If you need more help, visit Illinois Legal Aid Online at https://www.illinoislegalaid.org."
      }
    },
    {
      "name": "benefits-yn-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "benefits-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1740,
          "y": 780
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply No if you don't get any government benefits. \nEnter the number if you do; if you get more than one, please enter 1, 3 (for example)."
      }
    },
    {
      "name": "payments-yn-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "other-payments-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3199,
          "y": 1678
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "We couldn't understand your response.  Please enter No if you don't get any income from these sources. \nEnter the number if you do; if you get more than one, please enter 1, 3 (for example)."
      }
    },
    {
      "name": "update-triage-user-on-exit",
      "type": "run-function",
      "transitions": [
        {
          "next": "final-not-otis-exit",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2610,
          "y": 1560
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Diverted",
            "key": "intake_status"
          },
          {
            "value": "Program triage completed",
            "key": "triage_status"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "1",
            "key": "intake_created"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.id}}",
            "key": "intake_organization"
          },
          {
            "value": "{{flow.variables.legal-issue-uuid}}",
            "key": "triage_problem"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "triage_update_matches",
      "type": "run-function",
      "transitions": [
        {
          "next": "post-triage-start",
          "event": "success"
        },
        {
          "next": "post-triage-start",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2650,
          "y": 1860
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Started",
            "key": "intake_status"
          },
          {
            "value": "Program triage completed",
            "key": "triage_status"
          },
          {
            "value": "sms-matches",
            "key": "last_screen_viewed"
          },
          {
            "value": "1",
            "key": "intake_created"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "{{flow.variables.intake_organization}}",
            "key": "intake_organization"
          },
          {
            "value": "{{flow.variables.legal-issue-uuid}}",
            "key": "triage_problem"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "set_triage_init_data",
      "type": "set-variables",
      "transitions": [
        {
          "next": "jurisdiction",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.create_triage_user_init.parsed.id}}",
            "key": "uuid"
          },
          {
            "value": "{{widgets.create_triage_user_init.parsed.triage_id}}",
            "key": "triage_id"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.county_id}}",
            "key": "county_id"
          }
        ],
        "offset": {
          "x": -1591,
          "y": -666
        }
      }
    },
    {
      "name": "set_household_size",
      "type": "set-variables",
      "transitions": [
        {
          "next": "update-household-size",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.calculate-income-estimate.parsed.household_size}}",
            "key": "household_size"
          }
        ],
        "offset": {
          "x": -1566,
          "y": 1366
        }
      }
    },
    {
      "name": "calculate-age",
      "type": "run-function",
      "transitions": [
        {
          "next": "update-triage-age",
          "event": "success"
        },
        {
          "next": "update-triage-age",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1560,
          "y": 1480
        },
        "function_sid": "ZHc53a78cad8bf43bea42c766642b42e5d",
        "parameters": [
          {
            "value": "{{widgets.dob-year.inbound.Body}}",
            "key": "year"
          },
          {
            "value": "{{widgets.dob-day.inbound.Body}}",
            "key": "month"
          },
          {
            "value": "{{widgets.dob-day.inbound.Body}}",
            "key": "day"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-calculate-age"
      }
    },
    {
      "name": "update-triage-age",
      "type": "run-function",
      "transitions": [
        {
          "next": "demo-start",
          "event": "success"
        },
        {
          "next": "demo-start",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1680,
          "y": 1710
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "{{widgets.calculate-age.body}}",
            "key": "age"
          },
          {
            "value": "sms_date_of_birth",
            "key": "last_screen_viewed"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "update-triage-demo",
      "type": "run-function",
      "transitions": [
        {
          "next": "income-intro",
          "event": "success"
        },
        {
          "next": "income-intro",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 400,
          "y": 3590
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "{{widgets.validate-race-input.body}}",
            "key": "race"
          },
          {
            "value": "{{widgets.validate-gender.body}}",
            "key": "gender"
          },
          {
            "value": "{{widgets.validate-marital-status.body}}",
            "key": "marital_status"
          },
          {
            "value": "{{widgets.validate-preferred-language.body}}",
            "key": "primary_language"
          },
          {
            "value": "{{flow.variables.ethnicity}}",
            "key": "ethnicity"
          },
          {
            "value": "sms_demographics",
            "key": "last_screen_viewed"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "ethnicity-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "ethnicity-input",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -910,
          "y": 3004
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please make a valid selection."
      }
    },
    {
      "name": "set_ethnicity",
      "type": "set-variables",
      "transitions": [
        {
          "next": "get-genders",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.validate-ethnicity-input.body}}",
            "key": "ethnicity"
          }
        ],
        "offset": {
          "x": -1450,
          "y": 2730
        }
      }
    },
    {
      "name": "set-ethnicity-from-race",
      "type": "set-variables",
      "transitions": [
        {
          "next": "get-genders",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "Hispanic",
            "key": "ethnicity"
          }
        ],
        "offset": {
          "x": 2080,
          "y": 1420
        }
      }
    },
    {
      "name": "set-total-income",
      "type": "set-variables",
      "transitions": [
        {
          "next": "update-income",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.validate-income-level.parsed.income}}",
            "key": "total_income"
          },
          {
            "value": "{{widgets.validate-income-level.parsed.incomeFlag}}",
            "key": "overIncome"
          },
          {
            "value": "{{widgets.validate-income-level.parsed.frequency}}",
            "key": "frequency"
          }
        ],
        "offset": {
          "x": 3630,
          "y": 3220
        }
      }
    },
    {
      "name": "update-income",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-income-resources",
          "event": "success"
        },
        {
          "next": "route-income-resources",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3740,
          "y": 3470
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "{{flow.variables.overIncome}}",
            "key": "overIncome"
          },
          {
            "value": "{{flow.variables.total_income}}",
            "key": "total_income"
          },
          {
            "value": "sms-income-screens",
            "key": "last_screen_viewed"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "final-otis-update",
      "type": "run-function",
      "transitions": [
        {
          "next": "thanks",
          "event": "success"
        },
        {
          "next": "thanks",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 2210,
          "y": 4770
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "eTransferred",
            "key": "intake_status"
          },
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "sms-confirmation",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "language-start",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-language",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 580,
          "y": -370
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "For free legal help, you must have income of less than 80% of median income (about $47,600 for one person and $68,000 for a family of 4) and be in Illinois. \n\nYou can also apply online at https://go.illinoislegalaid.org/help-eviction\n\nReply Yes or Ok to start. Reply exit to end.",
        "timeout": "3600"
      }
    },
    {
      "name": "route-language",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "first-name",
          "event": "noMatch"
        },
        {
          "next": "spanish-redirect",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1",
              "arguments": [
                "{{widgets.language-start.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "1"
            }
          ]
        },
        {
          "next": "final-not-otis-exit",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to end",
              "arguments": [
                "{{widgets.language-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "end, exit"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.language-start.inbound.Body}}",
        "offset": {
          "x": -84,
          "y": -162
        }
      }
    },
    {
      "name": "get-counseling",
      "type": "run-function",
      "transitions": [
        {
          "next": "show-counseling",
          "event": "success"
        },
        {
          "next": "counseling-fail",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -460,
          "y": 40
        },
        "function_sid": "ZH176a303f4ea58c1c413adbe0cd9953bb",
        "parameters": [
          {
            "value": "{{widgets.zip-code.inbound.Body}}",
            "key": "zip"
          }
        ],
        "url": "https://ilao-8092.twil.io/hud-housing-counselors"
      }
    },
    {
      "name": "show-counseling",
      "type": "send-message",
      "transitions": [
        {
          "next": "show-more-counserlors-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 140,
          "y": 180
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Your best option is to contact a local housing counseling service.  The closest one to you is  {{widgets.get-counseling.parsed.options[0].name}}, {{widgets.get-counseling.parsed.options[0].address}}, {{widgets.get-counseling.parsed.options[0].city}}.\n\nYou can contact them at {{widgets.get-counseling.parsed.options[0].phone}}"
      }
    },
    {
      "name": "show-more-counserlors-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-show-counserlors-yn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 160,
          "y": 390
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "The agency offers:{{widgets.get-counseling.parsed.options[0].services}}\n\nThere are {{widgets.get-counseling.parsed.total}} more nearby counselors.   Would you like to see more counseling options?  Please reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "init-counselor-ctr",
      "type": "set-variables",
      "transitions": [
        {
          "next": "show-next-counselor",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "0",
            "key": "ctr"
          },
          {
            "value": "{{widgets.get-counseling.parsed.options[{{flow.variables.ctr}}].name}}",
            "key": "name"
          },
          {
            "value": "true",
            "key": "shown-housing"
          },
          {
            "value": "1",
            "key": "visual-ctr"
          }
        ],
        "offset": {
          "x": -140,
          "y": 240
        }
      }
    },
    {
      "name": "route-show-counserlors-yn",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "no-more-counselors",
          "event": "noMatch"
        },
        {
          "next": "init-counselor-ctr",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Y, Yes, Yep, Yeah",
              "arguments": [
                "{{widgets.show-more-counserlors-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Y, Yes, Yep, Yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.show-more-counserlors-yn.inbound.Body}}",
        "offset": {
          "x": 680,
          "y": 580
        }
      }
    },
    {
      "name": "show-next-counselor",
      "type": "send-message",
      "transitions": [
        {
          "next": "update-counseling-counter",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -850,
          "y": 320
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{% assign foo = flow.variables.ctr | plus: 0 %} \n{{flow.variables.visual-ctr}}. {{widgets.get-counseling.parsed.options[foo].name}} \n\n{{widgets.get-counseling.parsed.options[foo].address}}, {{widgets.get-counseling.parsed.options[foo].city}} \n\nPhone: {{widgets.get-counseling.parsed.options[foo].phone}}\nWebsite:  {{widgets.get-counseling.parsed.options[foo].weburl}}"
      }
    },
    {
      "name": "update-counseling-counter",
      "type": "set-variables",
      "transitions": [
        {
          "next": "route-more-counselors",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.ctr | plus: 1}}",
            "key": "ctr"
          },
          {
            "value": "{{flow.variables.visual-ctr | plus: 1}}",
            "key": "visual-ctr"
          }
        ],
        "offset": {
          "x": 720,
          "y": 810
        }
      }
    },
    {
      "name": "route-more-counselors",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "update-counseling",
          "event": "noMatch"
        },
        {
          "next": "show-next-counselor",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value less_than {{widgets.get-counseling.parsed.total}}",
              "arguments": [
                "{{flow.variables.ctr}}"
              ],
              "type": "less_than",
              "value": "{{widgets.get-counseling.parsed.total}}"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{flow.variables.ctr}}",
        "offset": {
          "x": -320,
          "y": 950
        }
      }
    },
    {
      "name": "benefits-help",
      "type": "send-message",
      "transitions": [
        {
          "next": "benefits-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3040,
          "y": 630
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Governement benefits are usually paid by the Illinois Department of Human Services, the Illinois Department of Employment Security, Veterans Administration, or Social Security Administration."
      }
    },
    {
      "name": "payments-help",
      "type": "send-message",
      "transitions": [
        {
          "next": "other-payments-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 4310,
          "y": 300
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Payments that you receive weekly should be multiplied by 52 and divided by 12.  For irregular payments, such as from investment income, take the average for the year and divide by 12."
      }
    },
    {
      "name": "other-income-help",
      "type": "send-message",
      "transitions": [
        {
          "next": "get-other-income-yn",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3279,
          "y": 2115
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Count other income if it is regularly received.  Examples include regular gifts from a family member or friend."
      }
    },
    {
      "name": "birthday-confirm",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "set-birthday-value",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1660,
          "y": 1950
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "We have your birthday as {{widgets.validate-month.body}}/{{widgets.validate-day.body}}/{{widgets.validate-dob-year.body}}.  Is this correct? Please reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "birthday-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "calculate-age",
          "event": "noMatch"
        },
        {
          "next": "dob-month",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, nope, n, not",
              "arguments": [
                "{{widgets.birthday-confirm.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, nope, n, not. No, N, Nope, Not"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.birthday-confirm.inbound.Body}}",
        "offset": {
          "x": 700,
          "y": 1600
        }
      }
    },
    {
      "name": "set-birthday-value",
      "type": "set-variables",
      "transitions": [
        {
          "next": "birthday-router",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "1",
            "key": "birthday-asked"
          }
        ],
        "offset": {
          "x": 770,
          "y": 1950
        }
      }
    },
    {
      "name": "validate-phone",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "set-asked-phone",
          "event": "noMatch"
        },
        {
          "next": "set_entered_phone",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value regex ^[0-9]{10}$",
              "arguments": [
                "{{widgets.get-best-number.inbound.Body}}"
              ],
              "type": "regex",
              "value": "^[0-9]{10}$"
            }
          ]
        },
        {
          "next": "set_entered_phone",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value regex ^[0-9]{10}x|X[0-9]",
              "arguments": [
                "{{widgets.get-best-number.inbound.Body}}"
              ],
              "type": "regex",
              "value": "^[0-9]{10}x[0-9]*"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-best-number.inbound.Body}}",
        "offset": {
          "x": 5300,
          "y": 3710
        }
      }
    },
    {
      "name": "set-asked-phone",
      "type": "set-variables",
      "transitions": [
        {
          "next": "get-best-number",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "1",
            "key": "asked-phone"
          }
        ],
        "offset": {
          "x": 5351,
          "y": 4060
        }
      }
    },
    {
      "name": "welcome",
      "type": "send-message",
      "transitions": [
        {
          "next": "language-start",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 910,
          "y": -410
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Hi!  This is the Eviction Help Illinois text line.  I can connect you to legal aid, housing counselors, and other help."
      }
    },
    {
      "name": "show-cook-county",
      "type": "send-message",
      "transitions": [
        {
          "next": "create_cook_country_record",
          "event": "sent"
        },
        {
          "next": "create_cook_country_record",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1120,
          "y": 660
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Sorry, at this time we can only connect users outside of Cook County via text. \n\nFor eviction help in Cook county, go to https://www.cookcountylegalaid.org/"
      }
    },
    {
      "name": "calculate-income-estimate",
      "type": "run-function",
      "transitions": [
        {
          "next": "route-household-values",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -910,
          "y": 880
        },
        "function_sid": "ZH7b0511e7417bf3c3a065df59aa2b4bf0",
        "parameters": [
          {
            "value": "{{widgets.household-adults.inbound.Body}}",
            "key": "adults"
          },
          {
            "value": "{{widgets.household-children.inbound.Body}}",
            "key": "children"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-poverty-estimate"
      }
    },
    {
      "name": "dob-month-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "dob-month",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1705,
          "y": 1760
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please enter a valid month name or number."
      }
    },
    {
      "name": "dob-year-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "dob-year",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1603,
          "y": 2435
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please enter a valid 2 or 4 digit year."
      }
    },
    {
      "name": "eviction-summons",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-eviction-summons",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1460,
          "y": -620
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "A summons is an official notice that a lawsuit has been filed against you. Have you gotten a summons?  Reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "route-eviction-summons",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "eviction-summons-error",
          "event": "noMatch"
        },
        {
          "next": "update_notes_for_eviction_summons",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Y, Yes, y, yes, yep, yeah, Yep, Yeah",
              "arguments": [
                "{{widgets.eviction-summons.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Y, Yes, y, yes, yep, yeah, Yep, Yeah"
            }
          ]
        },
        {
          "next": "eviction-notices",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these",
              "arguments": [
                "{{widgets.eviction-summons.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.eviction-summons.inbound.Body}}",
        "offset": {
          "x": 1860,
          "y": -650
        }
      }
    },
    {
      "name": "eviction-notices",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-eviction-noties",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1837,
          "y": -17
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Have you gotten any written notices from your landlord?  Reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "route-eviction-noties",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "written-notice-error",
          "event": "noMatch"
        },
        {
          "next": "set-eviction-notice-notes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Y, Yes, yes, y, yep, yeah, Yep, Yeah",
              "arguments": [
                "{{widgets.eviction-notices.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Y, Yes, yes, y, yep, yeah, Yep, Yeah"
            }
          ]
        },
        {
          "next": "eviction-threat",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these",
              "arguments": [
                "{{widgets.eviction-notices.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.eviction-notices.inbound.Body}}",
        "offset": {
          "x": 1560,
          "y": 280
        }
      }
    },
    {
      "name": "eviction-threat",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-eviction-threat",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1860,
          "y": -420
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Has your landlord threatened to evict you? Reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "route-eviction-threat",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "eviction-threaten-error",
          "event": "noMatch"
        },
        {
          "next": "set-threatened-eviction-notes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes, y, Yes, Y, yep, yeah, Yep, Yeah",
              "arguments": [
                "{{widgets.eviction-threat.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "yes, y, Yes, Y, yep, yeah, Yep, Yeah"
            }
          ]
        },
        {
          "next": "get-content",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these",
              "arguments": [
                "{{widgets.eviction-threat.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.eviction-threat.inbound.Body}}",
        "offset": {
          "x": 2100,
          "y": -300
        }
      }
    },
    {
      "name": "lockout-utilities",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-lockout-utilities",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 2160,
          "y": -110
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Were your lights, water, or gas shut off because you didn't pay the bill to the utility company? Reply Yes or No",
        "timeout": "3600"
      }
    },
    {
      "name": "route-lockout-utilities",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "utilities-error",
          "event": "noMatch"
        },
        {
          "next": "lockout-utility-divert",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of Yes, Y, yes, y, yep, yeah, Yep, Yeah",
              "arguments": [
                "{{widgets.lockout-utilities.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "Yes, Y, yes, y, yep, yeah, Yep, Yeah"
            }
          ]
        },
        {
          "next": "set-lockout-utilities-nots",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these",
              "arguments": [
                "{{widgets.lockout-utilities.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "no, n, N, NO, No, nO, false, nope, negative, none, not, nah, not a chance, none of these"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.lockout-utilities.inbound.Body}}",
        "offset": {
          "x": 2450,
          "y": -150
        }
      }
    },
    {
      "name": "legal-issue-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "legal-issue-start",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1253,
          "y": -267
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "We couldn't understand your response.  Please reply with the number that is the best match."
      }
    },
    {
      "name": "landlord-name",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "set-landlord-notes",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1410,
          "y": -120
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "What is the landlord's name?",
        "timeout": "3600"
      }
    },
    {
      "name": "self-employ-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "self-employ-collect",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3970,
          "y": 2230
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Let's try again. Please respond with a number."
      }
    },
    {
      "name": "wages-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "wages-collect",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2960,
          "y": -290
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Let's try again.  Please enter just a number.\n* You should include the total amount of money before any taxes are taken out\n* If you are unsure, please estimate/average"
      }
    },
    {
      "name": "wages-frequency",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "wage-frequency-validate",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1590,
          "y": 2980
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "How often do you get paid?\n1. Once a week\n2. Every 2 weeks\n3. Twice a month\n4. Once a month",
        "timeout": "3600"
      }
    },
    {
      "name": "wage-frequency-validate",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "wage-frequency-error",
          "event": "noMatch"
        },
        {
          "next": "wages-collect",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 1,2,3,4",
              "arguments": [
                "{{widgets.wages-frequency.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "1,2,3,4"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.wages-frequency.inbound.Body}}",
        "offset": {
          "x": 856,
          "y": 3520
        }
      }
    },
    {
      "name": "wage-frequency-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "wages-frequency",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1269,
          "y": 3136
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply with 1,2,3, or 4."
      }
    },
    {
      "name": "set-benefit-asked",
      "type": "set-variables",
      "transitions": [
        {
          "next": "benefits-yn",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "1",
            "key": "benefits-asked"
          }
        ],
        "offset": {
          "x": 3284,
          "y": -511
        }
      }
    },
    {
      "name": "set_other_payments_asked",
      "type": "set-variables",
      "transitions": [
        {
          "next": "other-payments-yn",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "1",
            "key": "other-payments-asked"
          }
        ],
        "offset": {
          "x": 4892,
          "y": -471
        }
      }
    },
    {
      "name": "counseling-fail",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -820,
          "y": -170
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "You can find a local housing counselor by visiting https://www.consumerfinance.gov/find-a-housing-counselor/"
      }
    },
    {
      "name": "no-more-counselors",
      "type": "send-message",
      "transitions": [
        {
          "next": "update-counseling",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1580,
          "y": 250
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "You can find more local housing counselors by visiting https://www.consumerfinance.gov/find-a-housing-counselor/"
      }
    },
    {
      "name": "overincome-message",
      "type": "send-message",
      "transitions": [
        {
          "next": "update_triage_user_overincome",
          "event": "sent"
        },
        {
          "next": "update_triage_user_overincome",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 4409,
          "y": 3134
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Based on your income information, we can not complete a referral to {{widgets.get-otis-matches.parsed.organization}}.\n\nYou can find other referrals and information by visiting https://www.illinoislegalaid.org/get-legal-help"
      }
    },
    {
      "name": "lockout-utility-divert",
      "type": "send-message",
      "transitions": [
        {
          "next": "update-lockout-divert",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3310,
          "y": -270
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "You will need to submit an application for this issue online at https://www.illinoislegalaid.org/get-legal-help"
      }
    },
    {
      "name": "legal_issue_validate",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "legal-issue-error",
          "event": "noMatch"
        },
        {
          "next": "get-eviction-issue",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 1,2,3,4,5,6,7",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "1,2,3,4,5,6,7"
            }
          ]
        },
        {
          "next": "legal-issue-help",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of More, more",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "More, more"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.legal-issue-start.inbound.Body}}",
        "offset": {
          "x": -1470,
          "y": -470
        }
      }
    },
    {
      "name": "get-content",
      "type": "run-function",
      "transitions": [
        {
          "next": "exit-with-information",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2390,
          "y": -120
        },
        "function_sid": "ZHecd7a1a8c705fef14797fed98d6e7538",
        "parameters": [
          {
            "value": "{{flow.variables.legal_issue}}",
            "key": "legal_issue"
          }
        ],
        "url": "https://ilao-8092.twil.io/eviction-content"
      }
    },
    {
      "name": "eviction-summons-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "eviction-summons",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2500,
          "y": -730
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply Yes or No."
      }
    },
    {
      "name": "eviction-threaten-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "eviction-threat",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2227,
          "y": -452
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply Yes or No"
      }
    },
    {
      "name": "written-notice-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "eviction-notices",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1056,
          "y": -609
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply Yes or No"
      }
    },
    {
      "name": "utilities-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "lockout-utilities",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3125,
          "y": -41
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply yes or no."
      }
    },
    {
      "name": "create_cook_country_record",
      "type": "run-function",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2200,
          "y": 130
        },
        "function_sid": "ZHe1947715a825416ef5ea4d2ffdeeab0c",
        "parameters": [
          {
            "value": "{{widgets.validate-zipcode.parsed.zip_code}}",
            "key": "zip_code"
          },
          {
            "value": "eviction-english",
            "key": "source"
          },
          {
            "value": "cook-county-exit",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{trigger.message.From}}",
            "key": "user_phone"
          },
          {
            "value": "{{widgets.validate-zipcode.parsed.county}}",
            "key": "county"
          },
          {
            "value": "{{trigger.message.Body}}",
            "key": "search"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-create-triage-user"
      }
    },
    {
      "name": "update_triage_user_overincome",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-content",
          "event": "success"
        },
        {
          "next": "get-content",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 4920,
          "y": 2960
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "1",
            "key": "overrincome"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "spanish-redirect",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -460,
          "y": -719
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "For Spanish, please text \"spanish\" to 1-844-xxx-xxxx."
      }
    },
    {
      "name": "update-lockout-divert",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-content",
          "event": "success"
        },
        {
          "next": "get-content",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 3014,
          "y": -700
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "sms_legal_issue_selector",
            "key": "last_screen_viewed"
          },
          {
            "value": "Diverted",
            "key": "intake_status"
          },
          {
            "value": "1",
            "key": "intake_changed"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.id}}",
            "key": "intake_organization"
          },
          {
            "value": "Program triage completed",
            "key": "triage_status"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "update-household-size",
      "type": "run-function",
      "transitions": [
        {
          "next": "last-name",
          "event": "success"
        },
        {
          "next": "last-name",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -1914,
          "y": 1991
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "{{flow.variables.household_size}}",
            "key": "household_size"
          },
          {
            "value": "{{widgets.household-adults.inbound.Body}}",
            "key": "household_adults"
          },
          {
            "value": "{{widgets.household-children.inbound.Body}}",
            "key": "household_children"
          },
          {
            "value": "sms_household_size",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "email-validation",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "email-error",
          "event": "noMatch"
        },
        {
          "next": "get-street-address",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to none",
              "arguments": [
                "{{widgets.get-email-address.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "none"
            }
          ]
        },
        {
          "next": "get-street-address",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains @",
              "arguments": [
                "{{widgets.get-email-address.inbound.Body}}"
              ],
              "type": "contains",
              "value": "@"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-email-address.inbound.Body}}",
        "offset": {
          "x": 5644,
          "y": 2999
        }
      }
    },
    {
      "name": "email-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "get-email-address",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 5700,
          "y": 3310
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please enter a valid email address or reply None."
      }
    },
    {
      "name": "get-eviction-issue",
      "type": "run-function",
      "transitions": [
        {
          "next": "set-eviction-issue-variables",
          "event": "success"
        },
        {
          "next": "legal-issue-split",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1332,
          "y": -411
        },
        "function_sid": "ZHb44dece5234d10aa14cc6466eaab1c3c",
        "parameters": [
          {
            "value": "{{widgets.legal-issue-start.inbound.Body}}",
            "key": "choice"
          }
        ],
        "url": "https://ilao-8092.twil.io/eviction-legal-issues"
      }
    },
    {
      "name": "set-eviction-issue-variables",
      "type": "set-variables",
      "transitions": [
        {
          "next": "legal-issue-split",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.get-eviction-issue.parsed.issue}}",
            "key": "legal-issue-name"
          },
          {
            "value": "{{widgets.get-eviction-issue.parsed.issue_id}}",
            "key": "legal-issue-uuid"
          },
          {
            "value": "{{widgets.get-eviction-issue.parsed.notes}}",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 724,
          "y": -742
        }
      }
    },
    {
      "name": "update_triage_declined",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-content",
          "event": "success"
        },
        {
          "next": "get-content",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -171,
          "y": -567
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Offered",
            "key": "intake_status"
          },
          {
            "value": "Program triage completed",
            "key": "triage_status"
          },
          {
            "value": "sms-match-offered",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "set_intake_settings_variables",
      "type": "set-variables",
      "transitions": [
        {
          "next": "triage_update_matches",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.get-otis-matches.parsed.legalservername}}",
            "key": "legalservername"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.please_call}}",
            "key": "please_call"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.we_call}}",
            "key": "we_call"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.id}}",
            "key": "id"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.id}}",
            "key": "intake_organization"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.callback_type}}",
            "key": "callback_type"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.organization}}",
            "key": "organization"
          }
        ],
        "offset": {
          "x": -3190,
          "y": 1880
        }
      }
    },
    {
      "name": "matches-returned-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "legal-issue-start",
          "event": "noMatch"
        },
        {
          "next": "exit-to-glh",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "get-otis-matches.body",
              "arguments": [
                "{{widgets.get-otis-matches.body}}"
              ],
              "type": "is_blank",
              "value": "Is Blank"
            }
          ]
        },
        {
          "next": "exit-to-glh",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to {}",
              "arguments": [
                "{{widgets.get-otis-matches.body}}"
              ],
              "type": "equal_to",
              "value": "{}"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-otis-matches.body}}",
        "offset": {
          "x": -1990,
          "y": 430
        }
      }
    },
    {
      "name": "ask-callback-preference",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "route-preferred-callback",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3400,
          "y": 3620
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "{{flow.variables.organization}} will call you within 2 business days.  Do you prefer a morning or afternoon callback?",
        "timeout": "3600"
      }
    },
    {
      "name": "route-preferred-callback",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "set-morning-callback",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains morn",
              "arguments": [
                "{{widgets.ask-callback-preference.inbound.Body}}"
              ],
              "type": "contains",
              "value": "morn"
            }
          ]
        },
        {
          "next": "set-afternoon-callback",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains afte",
              "arguments": [
                "{{widgets.ask-callback-preference.inbound.Body}}"
              ],
              "type": "contains",
              "value": "afte"
            }
          ]
        },
        {
          "next": "set-morning-callback",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to pm",
              "arguments": [
                "{{widgets.ask-callback-preference.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "am"
            }
          ]
        },
        {
          "next": "set-afternoon-callback",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to pm",
              "arguments": [
                "{{widgets.ask-callback-preference.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "pm"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.ask-callback-preference.inbound.Body}}",
        "offset": {
          "x": 3700,
          "y": 3880
        }
      }
    },
    {
      "name": "we-call-confirmation",
      "type": "send-message",
      "transitions": [
        {
          "next": "send-to-legal-server",
          "event": "sent"
        },
        {
          "next": "send-to-legal-server",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3351,
          "y": 3822
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.variables.organization}} will call you within 2 business days {{flow.variables.selected-callback}}\n\n{{flow.variables.we_call}}\n\n{{widgets.get-otis-matches.parsed.disclaimer}}"
      }
    },
    {
      "name": "callback-error",
      "type": "send-message",
      "transitions": [
        {
          "next": "ask-callback-preference",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 3879,
          "y": 3618
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Please reply morning or afternoon."
      }
    },
    {
      "name": "legal-issue-help",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "legal-issue-help-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 130,
          "y": -800
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "If you have gotten paperwork about an eviction, pick, \"Stopping or preventing an eviction\" to find help. If you are behind on rent but have not gotten anything from your landlord, pick, \"Help paying rent\" to find help. To learn whether youâ€™ve been locked out reply \"Lockout.\" \n\nTo return to the list of choices reply Start.",
        "timeout": "3600"
      }
    },
    {
      "name": "legal-issue-help-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "legal-issue-start",
          "event": "noMatch"
        },
        {
          "next": "legal-issue-help-lockouts",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of lockout, Lockout, lock out",
              "arguments": [
                "{{widgets.legal-issue-help.inbound.Body}}"
              ],
              "type": "contains",
              "value": "lock"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.legal-issue-help.inbound.Body}}",
        "offset": {
          "x": 280,
          "y": -250
        }
      }
    },
    {
      "name": "legal-issue-help-lockouts",
      "type": "send-message",
      "transitions": [
        {
          "next": "legal-issue-start",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -90,
          "y": -330
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "A lockout is when the landlord uses force to keep you from getting back into your unit. Your landlord cannot lock you out until you have gone to court and the judge has signed an order of eviction. Examples include, blocking entrances, removing or disabling appliances (unless for repair), removing your items, threatening to injure you or your roommate, threatening to damage your items, or removing doors or windows to your unit."
      }
    },
    {
      "name": "update_notes_for_eviction_summons",
      "type": "set-variables",
      "transitions": [
        {
          "next": "landlord-name",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}.  Client received summons: Yes",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 1990,
          "y": -1050
        }
      }
    },
    {
      "name": "set-eviction-notice-notes",
      "type": "set-variables",
      "transitions": [
        {
          "next": "landlord-name",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}.  Client received eviction notices: Yes",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 1539,
          "y": -824
        }
      }
    },
    {
      "name": "set-threatened-eviction-notes",
      "type": "set-variables",
      "transitions": [
        {
          "next": "landlord-name",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}.  Landlord threatening to evict tenant: Yes",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 1721,
          "y": -139
        }
      }
    },
    {
      "name": "set-landlord-notes",
      "type": "set-variables",
      "transitions": [
        {
          "next": "match-selected",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}.  Landlord name: {{widgets.landlord-name.inbound.Body}}",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 1383,
          "y": 54
        }
      }
    },
    {
      "name": "set-lockout-notes",
      "type": "set-variables",
      "transitions": [
        {
          "next": "check-bypass-1",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}.  Not a lockout due to utility shutoff.",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 476,
          "y": -66
        }
      }
    },
    {
      "name": "set-lockout-utilities-nots",
      "type": "set-variables",
      "transitions": [
        {
          "next": "check-bypass-1",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{flow.variables.notes}}. Landlord has or is threatening to shut off client's utilities",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 475,
          "y": 235
        }
      }
    },
    {
      "name": "check-bypass-1",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "match-selected",
          "event": "noMatch"
        },
        {
          "next": "check-bypass-lockout",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value starts_with Prairie",
              "arguments": [
                "{{widgets.get-otis-matches.parsed.organization}}"
              ],
              "type": "starts_with",
              "value": "Prairie"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.get-otis-matches.parsed.organization}}",
        "offset": {
          "x": -1940,
          "y": 670
        }
      }
    },
    {
      "name": "check-bypass-lockout",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "match-selected",
          "event": "noMatch"
        },
        {
          "next": "send-bypass-msg",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of 2,3,two,three,four,4",
              "arguments": [
                "{{widgets.legal-issue-start.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "2,3,two,three,four,4"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.legal-issue-start.inbound.Body}}",
        "offset": {
          "x": -2154,
          "y": 867
        }
      }
    },
    {
      "name": "send-bypass-msg",
      "type": "send-message",
      "transitions": [
        {
          "next": "update_triage_user_bypass",
          "event": "sent"
        },
        {
          "next": "update_triage_user_bypass",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -2210,
          "y": 1050
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{widgets.get-otis-matches.parsed.bypass}}"
      }
    },
    {
      "name": "update_triage_user_bypass",
      "type": "run-function",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2570,
          "y": 1140
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Bypass",
            "key": "intake_status"
          },
          {
            "value": "{{widgets.get-otis-matches.parsed.id}}",
            "key": "intake_organization"
          },
          {
            "value": "Program triage complete",
            "key": "triage_status"
          },
          {
            "value": "{{flow.variables.legal-issue-uuid}}",
            "key": "triage_problem"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "show-please-call-confirm",
      "type": "send-message",
      "transitions": [
        {
          "next": "send-to-legal-server",
          "event": "sent"
        },
        {
          "next": "send-to-legal-server",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1830,
          "y": 4570
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "{{flow.variables.please_call}}\n\n\n{{widgets.get-otis-matches.parsed.disclaimer}}"
      }
    },
    {
      "name": "set-morning-callback",
      "type": "set-variables",
      "transitions": [
        {
          "next": "we-call-confirmation",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "during the morning hours.",
            "key": "selected-callback"
          },
          {
            "value": "{{flow.variables.notes}} Callback preference:  Afternoon",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 4034,
          "y": 4107
        }
      }
    },
    {
      "name": "set-afternoon-callback",
      "type": "set-variables",
      "transitions": [
        {
          "next": "we-call-confirmation",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "during the afternoon hours.",
            "key": "selected-callback"
          },
          {
            "value": "{{flow.variables.notes}} Callback preference:  Afternoon",
            "key": "notes"
          }
        ],
        "offset": {
          "x": 3598,
          "y": 4102
        }
      }
    },
    {
      "name": "legal-server-error-handling",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "final-otis-update",
          "event": "noMatch"
        },
        {
          "next": "send-failure",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of true, TRUE, True",
              "arguments": [
                "{{widgets.send-to-legal-server.parsed.error}}"
              ],
              "type": "matches_any_of",
              "value": "true, TRUE, True"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.send-to-legal-server.parsed.error}}",
        "offset": {
          "x": 3469,
          "y": 4996
        }
      }
    },
    {
      "name": "send-failure",
      "type": "send-message",
      "transitions": [
        {
          "next": "final-otis-update",
          "event": "sent"
        },
        {
          "next": "final-otis-update",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 2850,
          "y": 5250
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "+16308811337",
        "body": "Hey Gwen, can you fix {{flow.sid}}?"
      }
    },
    {
      "name": "update-counseling",
      "type": "run-function",
      "transitions": [
        {
          "next": "get-content",
          "event": "success"
        },
        {
          "next": "get-content",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -740,
          "y": 1100
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "sms-counselors-list",
            "key": "last_screen_viewed"
          },
          {
            "value": "Program triage completed",
            "key": "triage_status"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "update-exit-not-issue",
      "type": "run-function",
      "transitions": [
        {
          "next": "exit-to-glh",
          "event": "success"
        },
        {
          "next": "exit-to-glh",
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": 1342,
          "y": 251
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Legal Issue",
            "key": "triage_status"
          },
          {
            "value": "sms-legal-issue",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "update-triage-on-no-match",
      "type": "run-function",
      "transitions": [
        {
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS69795091c6d6a63ddf33ae4cd773e000",
        "environment_sid": "ZE996b801f4078599c12a6517c09afc2cf",
        "offset": {
          "x": -2611,
          "y": 351
        },
        "function_sid": "ZH260bb18946a9e10ae0f175a4582e4c0f",
        "parameters": [
          {
            "value": "{{flow.variables.uuid}}",
            "key": "uuid"
          },
          {
            "value": "Referrals",
            "key": "triage_status"
          },
          {
            "value": "sms-no-matches",
            "key": "last_screen_viewed"
          },
          {
            "value": "{{flow.channel.address}}",
            "key": "flow_id"
          }
        ],
        "url": "https://ilao-8092.twil.io/otis-update-triage-user"
      }
    },
    {
      "name": "say_play_1",
      "type": "say-play",
      "transitions": [
        {
          "event": "audioComplete"
        }
      ],
      "properties": {
        "offset": {
          "x": -130,
          "y": -1040
        },
        "loop": 1,
        "say": "Hi!  This is the Fight Eviction text line.  At this time I can connect you to legal aid, housing counselors, and other help over text messaging or you can go to www.Illinois Legal Aid .org/ get legal help.",
        "language": "en-US"
      }
    },
    {
      "name": "confirm-address-yn",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "confirm-address-router",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 4391,
          "y": 3626
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Do we have the right contact information?\n\nPhone: {{flow.variables.user_phone}}\nEmail: {{widgets.get-email-address.inbound.Body}} \nStreet: {{widgets.get-street-address.inbound.Body}} \nCity: {{widgets.get-city.inbound.Body}} \nState:  Illinois\nZip code: {{widgets.zip-code.inbound.Body}} \n\nPlease reply Yes or No.",
        "timeout": "3600"
      }
    },
    {
      "name": "confirm-address-router",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "contact-number-yn",
          "event": "noMatch"
        },
        {
          "next": "route-contact-type",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah",
              "arguments": [
                "{{widgets.confirm-address-yn.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "y, Y, Yes, YES, yep, yeah, i do, i have, of course, totally, I do, I have, Of course, Of Course, Totally, Yep, Yeah"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.confirm-address-yn.inbound.Body}}",
        "offset": {
          "x": 4440,
          "y": 3840
        }
      }
    },
    {
      "name": "set_entered_phone",
      "type": "set-variables",
      "transitions": [
        {
          "next": "get-email-address",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{widgets.get-best-number.inbound.Body}}",
            "key": "user_phone"
          }
        ],
        "offset": {
          "x": 5890,
          "y": 3610
        }
      }
    },
    {
      "name": "set_trigger_phone",
      "type": "set-variables",
      "transitions": [
        {
          "next": "get-email-address",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "{{trigger.message.From}}",
            "key": "user_phone"
          }
        ],
        "offset": {
          "x": 5290,
          "y": 2580
        }
      }
    }
  ],
  "initial_state": "Trigger",
  "flags": {
    "allow_concurrent_calls": true
  }
}
